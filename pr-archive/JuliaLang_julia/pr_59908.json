{
  "url": "https://api.github.com/repos/JuliaLang/julia/issues/59908",
  "repository_url": "https://api.github.com/repos/JuliaLang/julia",
  "labels_url": "https://api.github.com/repos/JuliaLang/julia/issues/59908/labels{/name}",
  "comments_url": "https://api.github.com/repos/JuliaLang/julia/issues/59908/comments",
  "events_url": "https://api.github.com/repos/JuliaLang/julia/issues/59908/events",
  "html_url": "https://github.com/JuliaLang/julia/pull/59908",
  "id": 3530255392,
  "node_id": "PR_kwDOABkWpM6uhLxb",
  "number": 59908,
  "title": "absint: allow ad-hoc cancellation of concrete evaluation",
  "user": {
    "login": "aviatesk",
    "id": 40514306,
    "node_id": "MDQ6VXNlcjQwNTE0MzA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/40514306?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aviatesk",
    "html_url": "https://github.com/aviatesk",
    "followers_url": "https://api.github.com/users/aviatesk/followers",
    "following_url": "https://api.github.com/users/aviatesk/following{/other_user}",
    "gists_url": "https://api.github.com/users/aviatesk/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aviatesk/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aviatesk/subscriptions",
    "organizations_url": "https://api.github.com/users/aviatesk/orgs",
    "repos_url": "https://api.github.com/users/aviatesk/repos",
    "events_url": "https://api.github.com/users/aviatesk/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aviatesk/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 0,
  "created_at": "2025-10-19T17:07:42Z",
  "updated_at": "2025-11-21T11:28:53Z",
  "closed_at": "2025-10-20T17:57:46Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/JuliaLang/julia/pulls/59908",
    "html_url": "https://github.com/JuliaLang/julia/pull/59908",
    "diff_url": "https://github.com/JuliaLang/julia/pull/59908.diff",
    "patch_url": "https://github.com/JuliaLang/julia/pull/59908.patch",
    "merged_at": "2025-10-20T17:57:46Z"
  },
  "body": "This change is not necessary for `NativeInterpreter` at all, but is particularly useful for JET. For error reporting, which is the purpose of `JETAnalyzer`, it is desirable to present error causes in a user-understandable form even when concrete evaluation presents errors. This requires analysis using regular abstract interpretation (constant propagation) in general. However, to reduce false positives, the precision that concrete evaluation brings is very important, and completely disabling concrete evaluation is not desirable either. Currently, `JETAnalyzer` aims to avoid this tradeoff by limiting concrete evaluation to only some functions, but this approach does not scale and occasionally causes problems like JuliaLang/julia#59884.\r\n\r\nThis commit enables ad-hoc cancellation of concrete evaluation based on the result of `concrete_eval_call`, allowing `JETAnalyzer` to fallback to abstract interpretation only when concrete evaluation causes errors, fundamentally avoiding such problems.",
  "reactions": {
    "url": "https://api.github.com/repos/JuliaLang/julia/issues/59908/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/JuliaLang/julia/issues/59908/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "score": 1.0,
  "files": [
    {
      "sha": "208757be3ba3733f3815f45abfa4ce1951a9de87",
      "filename": "Compiler/src/abstractinterpretation.jl",
      "status": "modified",
      "additions": 6,
      "deletions": 5,
      "changes": 11,
      "blob_url": "https://github.com/JuliaLang/julia/blob/c8ea3615ca1cccddd52425bea66cc03f84d7a593/Compiler%2Fsrc%2Fabstractinterpretation.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/c8ea3615ca1cccddd52425bea66cc03f84d7a593/Compiler%2Fsrc%2Fabstractinterpretation.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/Compiler%2Fsrc%2Fabstractinterpretation.jl?ref=c8ea3615ca1cccddd52425bea66cc03f84d7a593",
      "patch": "@@ -872,11 +872,12 @@ function abstract_call_method_with_const_args(interp::AbstractInterpreter,\n     concrete_eval_result = nothing\n     if eligibility === :concrete_eval\n         concrete_eval_result = concrete_eval_call(interp, f, result, arginfo, sv, invokecall)\n-        # if we don't inline the result of this concrete evaluation,\n-        # give const-prop' a chance to inline a better method body\n-        if !may_optimize(interp) || (\n-            may_inline_concrete_result(concrete_eval_result.const_result::ConcreteResult) ||\n-            concrete_eval_result.rt === Bottom) # unless this call deterministically throws and thus is non-inlineable\n+        if (concrete_eval_result !== nothing &&  # allow external abstract interpreters to disable concrete evaluation ad-hoc\n+            # if we don't inline the result of this concrete evaluation,\n+            # give const-prop' a chance to inline a better method body\n+            (!may_optimize(interp) ||\n+             may_inline_concrete_result(concrete_eval_result.const_result::ConcreteResult) ||\n+             concrete_eval_result.rt === Bottom)) # unless this call deterministically throws and thus is non-inlineable\n             return concrete_eval_result\n         end\n         # TODO allow semi-concrete interp for this call?"
    }
  ]
}