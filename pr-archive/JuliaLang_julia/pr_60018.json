{
  "url": "https://api.github.com/repos/JuliaLang/julia/issues/60018",
  "repository_url": "https://api.github.com/repos/JuliaLang/julia",
  "labels_url": "https://api.github.com/repos/JuliaLang/julia/issues/60018/labels{/name}",
  "comments_url": "https://api.github.com/repos/JuliaLang/julia/issues/60018/comments",
  "events_url": "https://api.github.com/repos/JuliaLang/julia/issues/60018/events",
  "html_url": "https://github.com/JuliaLang/julia/pull/60018",
  "id": 3578529271,
  "node_id": "PR_kwDOABkWpM6xA0WS",
  "number": 60018,
  "title": "Provide mechanism for Julia syntax evolution",
  "user": {
    "login": "Keno",
    "id": 1291671,
    "node_id": "MDQ6VXNlcjEyOTE2NzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1291671?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Keno",
    "html_url": "https://github.com/Keno",
    "followers_url": "https://api.github.com/users/Keno/followers",
    "following_url": "https://api.github.com/users/Keno/following{/other_user}",
    "gists_url": "https://api.github.com/users/Keno/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Keno/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Keno/subscriptions",
    "organizations_url": "https://api.github.com/users/Keno/orgs",
    "repos_url": "https://api.github.com/users/Keno/repos",
    "events_url": "https://api.github.com/users/Keno/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Keno/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "JeffBezanson",
    "id": 744556,
    "node_id": "MDQ6VXNlcjc0NDU1Ng==",
    "avatar_url": "https://avatars.githubusercontent.com/u/744556?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JeffBezanson",
    "html_url": "https://github.com/JeffBezanson",
    "followers_url": "https://api.github.com/users/JeffBezanson/followers",
    "following_url": "https://api.github.com/users/JeffBezanson/following{/other_user}",
    "gists_url": "https://api.github.com/users/JeffBezanson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JeffBezanson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JeffBezanson/subscriptions",
    "organizations_url": "https://api.github.com/users/JeffBezanson/orgs",
    "repos_url": "https://api.github.com/users/JeffBezanson/repos",
    "events_url": "https://api.github.com/users/JeffBezanson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JeffBezanson/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "JeffBezanson",
      "id": 744556,
      "node_id": "MDQ6VXNlcjc0NDU1Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/744556?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeffBezanson",
      "html_url": "https://github.com/JeffBezanson",
      "followers_url": "https://api.github.com/users/JeffBezanson/followers",
      "following_url": "https://api.github.com/users/JeffBezanson/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeffBezanson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeffBezanson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeffBezanson/subscriptions",
      "organizations_url": "https://api.github.com/users/JeffBezanson/orgs",
      "repos_url": "https://api.github.com/users/JeffBezanson/repos",
      "events_url": "https://api.github.com/users/JeffBezanson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeffBezanson/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 21,
  "created_at": "2025-11-01T22:05:58Z",
  "updated_at": "2025-12-12T07:25:49Z",
  "closed_at": "2025-11-25T23:14:24Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/JuliaLang/julia/pulls/60018",
    "html_url": "https://github.com/JuliaLang/julia/pull/60018",
    "diff_url": "https://github.com/JuliaLang/julia/pull/60018.diff",
    "patch_url": "https://github.com/JuliaLang/julia/pull/60018.patch",
    "merged_at": "2025-11-25T23:14:24Z"
  },
  "body": "# Motivation\r\nThere are several corner cases in the Julia syntax that are essentially bugs or mistakes that we'd like to possibly remove, but can't due to backwards compatibility concerns.\r\n\r\nSimilarly, when adding new syntax features, there are often cases that overlap with valid (but often nonsensical) existing syntax. In the past, we've mostly done judegement calls of these being \"minor changes\", but as the package ecosystem grows, so does the chance of someone accidentally using these anyway and our \"minor changes\" have (subjectively) resulted in more breakages recently.\r\n\r\nFortunately, all the recent work on making the parser replacable, combined with the fact that JuliaSyntax already supports parsing multiple revisions of Julia syntax provides a solution here: Just let packages declare what version of the Julia syntax they are using. That way, packages would not break if we make changes to the syntax and they can be upgraded at their own pace the next time the author of that particular package upgrades to a new julia version.\r\n\r\n# Core mechanism\r\nThe way this works is simple. Right now, the parser function is always looked up in `Core._parse`. With this PR, it is instead looked up as `mod._internal_julia_parse` (slightly longer name to avoid conflicting with existing bindings of the name in downstream packages), or `Core._parse` if no such binding exists. Similar for `_lower`.\r\n\r\nThere is a macro `@Base.Experimental.set_syntax_version v\"1.xx\"` that will set the `_internal_julia_parse` (and inte the future the _lower version) to one that propagates the version to the parser, so users are not expected to manipulate the binding directly.\r\n\r\n# Versioned package loading\r\nThe loading system is extended to look at a new `syntax.julia_version` key in Project.toml (and Manifest for explicit environments). If no such key exists, it defaults to the minimum allowed version of the Julia compat. If no compat is defined, it defaults to the current Julia version. This is technically slightly less backwards compatible than defaulting this to Julia 1.13, but I think it will be less suprising in the future for the default syntax to match what is in the REPL. Most julia packages do already define a julia compat.\r\n\r\nNote that as a result of this, the code for parse compat ranges moves from Pkg to Base.\r\n\r\n# Syntax changes\r\nThis introduces two parser changes:\r\n1. `@VERSION` (and similar macrocall forms of a macro named `VERSION`) are now special and trigger the parser to push its version information into the source location field of the macrocall. Note that because this is in the parser, this affects all macros with the name. However, there is also logic on the macrocall side that discards this again if the macro cannot accept it. This special mechanism is used by the `Base.Experimental.@VERSION` macro to let users detect the parse version.\r\n\r\n2. The `module` syntax form gains a syntax version argument that is automatically populated with the parser's current version. This is the mechanism to propagate syntax information from the parser to the core mechanism above.\r\n\r\nNote that these are only active if a module has opted into 1.14 syntax, so macros that process `:module` exprs will not see these changes unless and until the calling module opts into 1.14 syntax via the above mentioned mechanisms (which is the primary advantage of this scheme).\r\n\r\n# Final words\r\n\r\nI should emphasize that I'm not proposing using this for any big syntax revolutions or anything. I would just like to start cleaning up a few corners of the syntax that I think are universally agreed to be bad but that we've kept for backwards compatibility. This way, by the time we get around to making a breaking revision, our entire ecosystem will have already upgraded to the new syntax.\r\n\r\n# Remaining TODO\r\n- [x] Standalone tests for the parser changes\r\n- [x] JuliaLowering update\r\n- [x] Pkg.jl side changes (https://github.com/JuliaLang/Pkg.jl/pull/4520)\r\n- [x] NEWS entry\r\n\r\n# Open questions\r\n\r\n- [x] What should be the version of the flisp parser?\r\n\r\nSome doc and test edits by Claude but mostly manual.",
  "reactions": {
    "url": "https://api.github.com/repos/JuliaLang/julia/issues/60018/reactions",
    "total_count": 22,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 12,
    "rocket": 7,
    "eyes": 3
  },
  "timeline_url": "https://api.github.com/repos/JuliaLang/julia/issues/60018/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "score": 1.0
}