{
  "url": "https://api.github.com/repos/JuliaLang/julia/issues/60434",
  "repository_url": "https://api.github.com/repos/JuliaLang/julia",
  "labels_url": "https://api.github.com/repos/JuliaLang/julia/issues/60434/labels{/name}",
  "comments_url": "https://api.github.com/repos/JuliaLang/julia/issues/60434/comments",
  "events_url": "https://api.github.com/repos/JuliaLang/julia/issues/60434/events",
  "html_url": "https://github.com/JuliaLang/julia/pull/60434",
  "id": 3748539594,
  "node_id": "PR_kwDOABkWpM654Ldn",
  "number": 60434,
  "title": "Don't set `Attribute::StackProtectStrong` when not using `CodeModel::Large`",
  "user": {
    "login": "ararslan",
    "id": 6396159,
    "node_id": "MDQ6VXNlcjYzOTYxNTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6396159?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ararslan",
    "html_url": "https://github.com/ararslan",
    "followers_url": "https://api.github.com/users/ararslan/followers",
    "following_url": "https://api.github.com/users/ararslan/following{/other_user}",
    "gists_url": "https://api.github.com/users/ararslan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ararslan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ararslan/subscriptions",
    "organizations_url": "https://api.github.com/users/ararslan/orgs",
    "repos_url": "https://api.github.com/users/ararslan/repos",
    "events_url": "https://api.github.com/users/ararslan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ararslan/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 128750885,
      "node_id": "MDU6TGFiZWwxMjg3NTA4ODU=",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/system:arm",
      "name": "system:arm",
      "color": "4B9197",
      "default": false,
      "description": "ARMv7 and AArch64"
    },
    {
      "id": 183231688,
      "node_id": "MDU6TGFiZWwxODMyMzE2ODg=",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/compiler:codegen",
      "name": "compiler:codegen",
      "color": "d4c5f9",
      "default": false,
      "description": "Generation of LLVM IR and native code"
    },
    {
      "id": 414648058,
      "node_id": "MDU6TGFiZWw0MTQ2NDgwNTg=",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/bugfix",
      "name": "bugfix",
      "color": "15ff91",
      "default": false,
      "description": "This change fixes an existing bug"
    },
    {
      "id": 6857349323,
      "node_id": "LA_kwDOABkWpM8AAAABmLrYyw",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/system:riscv",
      "name": "system:riscv",
      "color": "fef2c0",
      "default": false,
      "description": "Support for Risc-V cpus"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 7,
  "created_at": "2025-12-19T19:15:28Z",
  "updated_at": "2026-01-04T14:40:49Z",
  "closed_at": "2026-01-04T14:40:48Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/JuliaLang/julia/pulls/60434",
    "html_url": "https://github.com/JuliaLang/julia/pull/60434",
    "diff_url": "https://github.com/JuliaLang/julia/pull/60434.diff",
    "patch_url": "https://github.com/JuliaLang/julia/pull/60434.patch",
    "merged_at": "2026-01-04T14:40:48Z"
  },
  "body": "We're currently setting `Attribute::StackProtectStrong` for all debug builds, but that can run into issues like what was observed on FreeBSD AArch64 in #59303, where the stack canary gets relocated out of the range permitted by the (there, small) code model. To avoid this problem more generally, we can just not set the strong stack protection attribute for debug builds on platforms not using a large code model. An alternative would be to use the large code model on more platforms, but some combinations of architecture and code model are not well-maintained in LLVM, so this seems safer.\r\n\r\nFixes #59303",
  "reactions": {
    "url": "https://api.github.com/repos/JuliaLang/julia/issues/60434/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/JuliaLang/julia/issues/60434/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "score": 1.0,
  "files": [
    {
      "sha": "a51f9ea2020ca205ca5f16de7a86e2ddd4adac7f",
      "filename": "src/codegen.cpp",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/JuliaLang/julia/blob/8fb972c50791a2b69aad25b97050002c4323b021/src%2Fcodegen.cpp",
      "raw_url": "https://github.com/JuliaLang/julia/raw/8fb972c50791a2b69aad25b97050002c4323b021/src%2Fcodegen.cpp",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/src%2Fcodegen.cpp?ref=8fb972c50791a2b69aad25b97050002c4323b021",
      "patch": "@@ -8722,7 +8722,9 @@ static jl_llvm_functions_t\n     if (src->inlining == 2)\n         FnAttrs.addAttribute(Attribute::NoInline);\n \n-#ifdef JL_DEBUG_BUILD\n+    // Add strong stack protection for debug builds only when using the large code model,\n+    // otherwise LLVM might try to relocate the stack canary out of range (see e.g. #59303)\n+#if defined(JL_DEBUG_BUILD) && !(defined(_CPU_AARCH64_) || defined(_CPU_RISCV_))\n     FnAttrs.addAttribute(Attribute::StackProtectStrong);\n #endif\n "
    }
  ]
}