{
  "url": "https://api.github.com/repos/JuliaLang/julia/issues/60573",
  "repository_url": "https://api.github.com/repos/JuliaLang/julia",
  "labels_url": "https://api.github.com/repos/JuliaLang/julia/issues/60573/labels{/name}",
  "comments_url": "https://api.github.com/repos/JuliaLang/julia/issues/60573/comments",
  "events_url": "https://api.github.com/repos/JuliaLang/julia/issues/60573/events",
  "html_url": "https://github.com/JuliaLang/julia/pull/60573",
  "id": 3786624828,
  "node_id": "PR_kwDOABkWpM67zJmh",
  "number": 60573,
  "title": "Markdown: add newline at end of non-empty code blocks",
  "user": {
    "login": "fingolfin",
    "id": 241512,
    "node_id": "MDQ6VXNlcjI0MTUxMg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/241512?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fingolfin",
    "html_url": "https://github.com/fingolfin",
    "followers_url": "https://api.github.com/users/fingolfin/followers",
    "following_url": "https://api.github.com/users/fingolfin/following{/other_user}",
    "gists_url": "https://api.github.com/users/fingolfin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fingolfin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fingolfin/subscriptions",
    "organizations_url": "https://api.github.com/users/fingolfin/orgs",
    "repos_url": "https://api.github.com/users/fingolfin/repos",
    "events_url": "https://api.github.com/users/fingolfin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fingolfin/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2317339600,
      "node_id": "MDU6TGFiZWwyMzE3MzM5NjAw",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/markdown",
      "name": "markdown",
      "color": "D914CD",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 0,
  "created_at": "2026-01-06T21:38:36Z",
  "updated_at": "2026-01-07T20:56:55Z",
  "closed_at": "2026-01-07T20:56:53Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/JuliaLang/julia/pulls/60573",
    "html_url": "https://github.com/JuliaLang/julia/pull/60573",
    "diff_url": "https://github.com/JuliaLang/julia/pull/60573.diff",
    "patch_url": "https://github.com/JuliaLang/julia/pull/60573.patch",
    "merged_at": "2026-01-07T20:56:53Z"
  },
  "body": "Fixes 36 of the CommonMark spec tests.",
  "reactions": {
    "url": "https://api.github.com/repos/JuliaLang/julia/issues/60573/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/JuliaLang/julia/issues/60573/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "score": 1.0,
  "files": [
    {
      "sha": "6501adfd981c46612a607c9e143f5083975bb8f6",
      "filename": "stdlib/Markdown/src/render/html.jl",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/JuliaLang/julia/blob/93e31ea8a859bbf8ec7dde73135e94911db1ae13/stdlib%2FMarkdown%2Fsrc%2Frender%2Fhtml.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/93e31ea8a859bbf8ec7dde73135e94911db1ae13/stdlib%2FMarkdown%2Fsrc%2Frender%2Fhtml.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/stdlib%2FMarkdown%2Fsrc%2Frender%2Fhtml.jl?ref=93e31ea8a859bbf8ec7dde73135e94911db1ae13",
      "patch": "@@ -63,7 +63,7 @@ function html(io::IO, code\u2032::Code)\n         maybe_lang = !isempty(code.language) ? Any[:class=>\"language-$(code.language)\"] : []\n         withtag(io, :code, maybe_lang...) do\n             htmlesc(io, code.code)\n-            # TODO should print newline if this is longer than one line ?\n+            !isempty(code.code) && println(io)\n         end\n     end\n end"
    },
    {
      "sha": "f4a0a9900fd012cfcbe1b49e4ebe9b5f0c050a03",
      "filename": "stdlib/Markdown/test/runtests.jl",
      "status": "modified",
      "additions": 9,
      "deletions": 5,
      "changes": 14,
      "blob_url": "https://github.com/JuliaLang/julia/blob/93e31ea8a859bbf8ec7dde73135e94911db1ae13/stdlib%2FMarkdown%2Ftest%2Fruntests.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/93e31ea8a859bbf8ec7dde73135e94911db1ae13/stdlib%2FMarkdown%2Ftest%2Fruntests.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/stdlib%2FMarkdown%2Ftest%2Fruntests.jl?ref=93e31ea8a859bbf8ec7dde73135e94911db1ae13",
      "patch": "@@ -387,7 +387,7 @@ end\n         code1\n \n         code2\n-    \"\"\" |> html == \"<pre><code>code1\\n\\ncode2</code></pre>\\n\" # single code block\n+    \"\"\" |> html == \"<pre><code>code1\\n\\ncode2\\n</code></pre>\\n\" # single code block\n \n     # @test md\"\"\"\n     # - Foo\n@@ -1100,7 +1100,8 @@ end\n             \"\"\"\n             <ol>\n             <li><p>A paragraph with two lines.</p>\n-            <pre><code>indented code</code></pre>\n+            <pre><code>indented code\n+            </code></pre>\n             <blockquote>\n             <p>A block quote.</p>\n             </blockquote>\n@@ -1119,7 +1120,8 @@ end\n             <ul>\n             <li><p>baz</p>\n             </li>\n-            <li><pre><code>foo</code></pre>\n+            <li><pre><code>foo\n+            </code></pre>\n             </li>\n             </ul>\n             <ol>\n@@ -1492,15 +1494,17 @@ end\n     <pre><code class=\"language-julia\">domaths(x::Number) = x + 5\n \n \n-    domath(x::Int) = x + 10</code></pre>\n+    domath(x::Int) = x + 10\n+    </code></pre>\n     </li>\n     <li><p>another entry, now testing code blocks without fences</p>\n     <pre><code># this is a code block\n     x = 1 + 1\n \n \n     # Two empty lines don't interrupt the code\n-    y = x * 3</code></pre>\n+    y = x * 3\n+    </code></pre>\n     </li>\n     <li><p>a final list entry</p>\n     </li>"
    },
    {
      "sha": "aecf5d44923e3d34187c30c331853ad9fe56c289",
      "filename": "stdlib/Markdown/test/test_spec.jl",
      "status": "modified",
      "additions": 36,
      "deletions": 36,
      "changes": 72,
      "blob_url": "https://github.com/JuliaLang/julia/blob/93e31ea8a859bbf8ec7dde73135e94911db1ae13/stdlib%2FMarkdown%2Ftest%2Ftest_spec.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/93e31ea8a859bbf8ec7dde73135e94911db1ae13/stdlib%2FMarkdown%2Ftest%2Ftest_spec.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/stdlib%2FMarkdown%2Ftest%2Ftest_spec.jl?ref=93e31ea8a859bbf8ec7dde73135e94911db1ae13",
      "patch": "@@ -15,7 +15,7 @@ using Markdown\n     input = \"\\tfoo\\tbaz\\t\\tbim\\n\"\n     expected = \"<pre><code>foo\\tbaz\\t\\tbim\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 2\n     input = \"  \\tfoo\\tbaz\\t\\tbim\\n\"\n@@ -27,7 +27,7 @@ using Markdown\n     input = \"    a\\ta\\n    \u1f50\\ta\\n\"\n     expected = \"<pre><code>a\\ta\\n\u1f50\\ta\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 4\n     input = \"  - foo\\n\\n\\tbar\\n\"\n@@ -57,7 +57,7 @@ using Markdown\n     input = \"    foo\\n\\tbar\\n\"\n     expected = \"<pre><code>foo\\nbar\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 9\n     input = \" - foo\\n   - bar\\n\\t - baz\\n\"\n@@ -124,13 +124,13 @@ end\n     input = \"    \\\\[\\\\]\\n\"\n     expected = \"<pre><code>\\\\[\\\\]\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 19\n     input = \"~~~\\n\\\\[\\\\]\\n~~~\\n\"\n     expected = \"<pre><code>\\\\[\\\\]\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 20\n     input = \"<https://example.com?find=\\\\*>\\n\"\n@@ -239,7 +239,7 @@ end\n     input = \"    f&ouml;f&ouml;\\n\"\n     expected = \"<pre><code>f&amp;ouml;f&amp;ouml;\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 37\n     input = \"&#42;foo&#42;\\n*foo*\\n\"\n@@ -325,7 +325,7 @@ end\n     input = \"    ***\\n\"\n     expected = \"<pre><code>***\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 49\n     input = \"Foo\\n    ***\\n\"\n@@ -458,7 +458,7 @@ end\n     input = \"    # foo\\n\"\n     expected = \"<pre><code># foo\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 70\n     input = \"foo\\n    # bar\\n\"\n@@ -561,7 +561,7 @@ end\n     input = \"    Foo\\n    ---\\n\\n    Foo\\n---\\n\"\n     expected = \"<pre><code>Foo\\n---\\n\\nFoo\\n</code></pre>\\n<hr />\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 86\n     input = \"Foo\\n   ----      \\n\"\n@@ -651,7 +651,7 @@ end\n     input = \"    foo\\n---\\n\"\n     expected = \"<pre><code>foo\\n</code></pre>\\n<hr />\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 101\n     input = \"> foo\\n-----\\n\"\n@@ -700,7 +700,7 @@ end\n     input = \"    a simple\\n      indented code block\\n\"\n     expected = \"<pre><code>a simple\\n  indented code block\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 108\n     input = \"  - foo\\n\\n    bar\\n\"\n@@ -718,19 +718,19 @@ end\n     input = \"    <a/>\\n    *hi*\\n\\n    - one\\n\"\n     expected = \"<pre><code>&lt;a/&gt;\\n*hi*\\n\\n- one\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 111\n     input = \"    chunk1\\n\\n    chunk2\\n  \\n \\n \\n    chunk3\\n\"\n     expected = \"<pre><code>chunk1\\n\\nchunk2\\n\\n\\n\\nchunk3\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 112\n     input = \"    chunk1\\n      \\n      chunk2\\n\"\n     expected = \"<pre><code>chunk1\\n  \\n  chunk2\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 113\n     input = \"Foo\\n    bar\\n\\n\"\n@@ -742,25 +742,25 @@ end\n     input = \"    foo\\nbar\\n\"\n     expected = \"<pre><code>foo\\n</code></pre>\\n<p>bar</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 115\n     input = \"# Heading\\n    foo\\nHeading\\n------\\n    foo\\n----\\n\"\n     expected = \"<h1>Heading</h1>\\n<pre><code>foo\\n</code></pre>\\n<h2>Heading</h2>\\n<pre><code>foo\\n</code></pre>\\n<hr />\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 116\n     input = \"        foo\\n    bar\\n\"\n     expected = \"<pre><code>    foo\\nbar\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 117\n     input = \"\\n    \\n    foo\\n    \\n\\n\"\n     expected = \"<pre><code>foo\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 118\n     input = \"    foo  \\n\"\n@@ -779,13 +779,13 @@ end\n     input = \"```\\n<\\n >\\n```\\n\"\n     expected = \"<pre><code>&lt;\\n &gt;\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 120\n     input = \"~~~\\n<\\n >\\n~~~\\n\"\n     expected = \"<pre><code>&lt;\\n &gt;\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 121\n     input = \"``\\nfoo\\n``\\n\"\n@@ -797,13 +797,13 @@ end\n     input = \"```\\naaa\\n~~~\\n```\\n\"\n     expected = \"<pre><code>aaa\\n~~~\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 123\n     input = \"~~~\\naaa\\n```\\n~~~\\n\"\n     expected = \"<pre><code>aaa\\n```\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 124\n     input = \"````\\naaa\\n```\\n``````\\n\"\n@@ -815,7 +815,7 @@ end\n     input = \"~~~~\\naaa\\n~~~\\n~~~~\\n\"\n     expected = \"<pre><code>aaa\\n~~~\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 126\n     input = \"```\\n\"\n@@ -839,7 +839,7 @@ end\n     input = \"```\\n\\n  \\n```\\n\"\n     expected = \"<pre><code>\\n  \\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 130\n     input = \"```\\n```\\n\"\n@@ -869,7 +869,7 @@ end\n     input = \"    ```\\n    aaa\\n    ```\\n\"\n     expected = \"<pre><code>```\\naaa\\n```\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 135\n     input = \"```\\naaa\\n  ```\\n\"\n@@ -905,19 +905,19 @@ end\n     input = \"foo\\n```\\nbar\\n```\\nbaz\\n\"\n     expected = \"<p>foo</p>\\n<pre><code>bar\\n</code></pre>\\n<p>baz</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 141\n     input = \"foo\\n---\\n~~~\\nbar\\n~~~\\n# baz\\n\"\n     expected = \"<h2>foo</h2>\\n<pre><code>bar\\n</code></pre>\\n<h1>baz</h1>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 142\n     input = \"```ruby\\ndef foo(x)\\n  return 3\\nend\\n```\\n\"\n     expected = \"<pre><code class=\\\"language-ruby\\\">def foo(x)\\n  return 3\\nend\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 143\n     input = \"~~~~    ruby startline=3 \\$%@#\\$\\ndef foo(x)\\n  return 3\\nend\\n~~~~~~~\\n\"\n@@ -1345,13 +1345,13 @@ end\n     input = \"    [foo]: /url \\\"title\\\"\\n\\n[foo]\\n\"\n     expected = \"<pre><code>[foo]: /url &quot;title&quot;\\n</code></pre>\\n<p>[foo]</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 212\n     input = \"```\\n[foo]: /url\\n```\\n\\n[foo]\\n\"\n     expected = \"<pre><code>[foo]: /url\\n</code></pre>\\n<p>[foo]</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 213\n     input = \"Foo\\n[bar]: /baz\\n\\n[bar]\\n\"\n@@ -1436,7 +1436,7 @@ end\n     input = \"    aaa\\nbbb\\n\"\n     expected = \"<pre><code>aaa\\n</code></pre>\\n<p>bbb</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 226\n     input = \"aaa     \\nbbb     \\n\"\n@@ -1486,7 +1486,7 @@ end\n     input = \"    > # Foo\\n    > bar\\n    > baz\\n\"\n     expected = \"<pre><code>&gt; # Foo\\n&gt; bar\\n&gt; baz\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 232\n     input = \"> # Foo\\n> bar\\nbaz\\n\"\n@@ -1516,7 +1516,7 @@ end\n     input = \">     foo\\n    bar\\n\"\n     expected = \"<blockquote>\\n<pre><code>foo\\n</code></pre>\\n</blockquote>\\n<pre><code>bar\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 237\n     input = \"> ```\\nfoo\\n```\\n\"\n@@ -1612,7 +1612,7 @@ end\n     input = \">     code\\n\\n>    not code\\n\"\n     expected = \"<blockquote>\\n<pre><code>code\\n</code></pre>\\n</blockquote>\\n<blockquote>\\n<p>not code</p>\\n</blockquote>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n end\n \n@@ -1739,7 +1739,7 @@ end\n     input = \"    indented code\\n\\nparagraph\\n\\n    more code\\n\"\n     expected = \"<pre><code>indented code\\n</code></pre>\\n<p>paragraph</p>\\n<pre><code>more code\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 273\n     input = \"1.     indented code\\n\\n   paragraph\\n\\n       more code\\n\"\n@@ -1841,7 +1841,7 @@ end\n     input = \"    1.  A paragraph\\n        with two lines.\\n\\n            indented code\\n\\n        > A block quote.\\n\"\n     expected = \"<pre><code>1.  A paragraph\\n    with two lines.\\n\\n        indented code\\n\\n    &gt; A block quote.\\n</code></pre>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 290\n     input = \"  1.  A paragraph\\nwith two lines.\\n\\n          indented code\\n\\n      > A block quote.\\n\""
    }
  ]
}