{
  "url": "https://api.github.com/repos/JuliaLang/julia/issues/59603",
  "repository_url": "https://api.github.com/repos/JuliaLang/julia",
  "labels_url": "https://api.github.com/repos/JuliaLang/julia/issues/59603/labels{/name}",
  "comments_url": "https://api.github.com/repos/JuliaLang/julia/issues/59603/comments",
  "events_url": "https://api.github.com/repos/JuliaLang/julia/issues/59603/events",
  "html_url": "https://github.com/JuliaLang/julia/pull/59603",
  "id": 3433738423,
  "node_id": "PR_kwDOABkWpM6peQv9",
  "number": 59603,
  "title": "Improve char to int parsing, and add `tryparse` method",
  "user": {
    "login": "jakobnissen",
    "id": 23193950,
    "node_id": "MDQ6VXNlcjIzMTkzOTUw",
    "avatar_url": "https://avatars.githubusercontent.com/u/23193950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jakobnissen",
    "html_url": "https://github.com/jakobnissen",
    "followers_url": "https://api.github.com/users/jakobnissen/followers",
    "following_url": "https://api.github.com/users/jakobnissen/following{/other_user}",
    "gists_url": "https://api.github.com/users/jakobnissen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jakobnissen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jakobnissen/subscriptions",
    "organizations_url": "https://api.github.com/users/jakobnissen/orgs",
    "repos_url": "https://api.github.com/users/jakobnissen/repos",
    "events_url": "https://api.github.com/users/jakobnissen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jakobnissen/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 115858,
      "node_id": "MDU6TGFiZWwxMTU4NTg=",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/performance",
      "name": "performance",
      "color": "d7e102",
      "default": false,
      "description": "Must go faster"
    },
    {
      "id": 269951426,
      "node_id": "MDU6TGFiZWwyNjk5NTE0MjY=",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/strings",
      "name": "strings",
      "color": "006b75",
      "default": false,
      "description": "\"Strings!\""
    },
    {
      "id": 6961181883,
      "node_id": "LA_kwDOABkWpM8AAAABnus0uw",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/reverted",
      "name": "reverted",
      "color": "EC7B22",
      "default": false,
      "description": "This PR has since been reverted"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "LilithHafner",
    "id": 60898866,
    "node_id": "MDQ6VXNlcjYwODk4ODY2",
    "avatar_url": "https://avatars.githubusercontent.com/u/60898866?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/LilithHafner",
    "html_url": "https://github.com/LilithHafner",
    "followers_url": "https://api.github.com/users/LilithHafner/followers",
    "following_url": "https://api.github.com/users/LilithHafner/following{/other_user}",
    "gists_url": "https://api.github.com/users/LilithHafner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/LilithHafner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/LilithHafner/subscriptions",
    "organizations_url": "https://api.github.com/users/LilithHafner/orgs",
    "repos_url": "https://api.github.com/users/LilithHafner/repos",
    "events_url": "https://api.github.com/users/LilithHafner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/LilithHafner/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "LilithHafner",
      "id": 60898866,
      "node_id": "MDQ6VXNlcjYwODk4ODY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/60898866?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LilithHafner",
      "html_url": "https://github.com/LilithHafner",
      "followers_url": "https://api.github.com/users/LilithHafner/followers",
      "following_url": "https://api.github.com/users/LilithHafner/following{/other_user}",
      "gists_url": "https://api.github.com/users/LilithHafner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LilithHafner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LilithHafner/subscriptions",
      "organizations_url": "https://api.github.com/users/LilithHafner/orgs",
      "repos_url": "https://api.github.com/users/LilithHafner/repos",
      "events_url": "https://api.github.com/users/LilithHafner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LilithHafner/received_events",
      "type": "User",
      "user_view_type": "public",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2025-09-19T10:04:59Z",
  "updated_at": "2025-10-11T22:26:09Z",
  "closed_at": "2025-10-09T08:56:39Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/JuliaLang/julia/pulls/59603",
    "html_url": "https://github.com/JuliaLang/julia/pull/59603",
    "diff_url": "https://github.com/JuliaLang/julia/pull/59603.diff",
    "patch_url": "https://github.com/JuliaLang/julia/pull/59603.patch",
    "merged_at": "2025-10-09T08:56:39Z"
  },
  "body": "This was orignially a larger PR, but I've shelved the larger refactoring for now.\r\nThis PR does two things:\r\n\r\n* Add a new method `tryparse(::Type{T}, c::AbstractChar; base::Integer=10) where {T <: Integer}` which was previously missing\r\n* Speed up parsing of chars to integer by ~4x",
  "reactions": {
    "url": "https://api.github.com/repos/JuliaLang/julia/issues/59603/reactions",
    "total_count": 4,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 4,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/JuliaLang/julia/issues/59603/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "score": 1.0,
  "files": [
    {
      "sha": "da6bfe7d409332f0785b3b5749d27bffd90eb0d7",
      "filename": "base/parse.jl",
      "status": "modified",
      "additions": 32,
      "deletions": 11,
      "changes": 43,
      "blob_url": "https://github.com/JuliaLang/julia/blob/b122d43d7f055a328c6d307e23f102f7c6c7c31b/base%2Fparse.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/b122d43d7f055a328c6d307e23f102f7c6c7c31b/base%2Fparse.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/base%2Fparse.jl?ref=b122d43d7f055a328c6d307e23f102f7c6c7c31b",
      "patch": "@@ -38,16 +38,38 @@ julia> parse(Complex{Float64}, \"3.2e-1 + 4.5im\")\n parse(T::Type, str; base = Int)\n parse(::Type{Union{}}, slurp...; kwargs...) = error(\"cannot parse a value as Union{}\")\n \n-function parse(::Type{T}, c::AbstractChar; base::Integer = 10) where T<:Integer\n-    a::Int = (base <= 36 ? 10 : 36)\n-    2 <= base <= 62 || throw(ArgumentError(\"invalid base: base must be 2 \u2264 base \u2264 62, got $base\"))\n-    d = '0' <= c <= '9' ? c-'0'    :\n-        'A' <= c <= 'Z' ? c-'A'+10 :\n-        'a' <= c <= 'z' ? c-'a'+a  : throw(ArgumentError(\"invalid digit: $(repr(c))\"))\n-    d < base || throw(ArgumentError(\"invalid base $base digit $(repr(c))\"))\n-    convert(T, d)\n+@noinline function _invalid_base(base)\n+    throw(ArgumentError(\"invalid base: base must be 2 \u2264 base \u2264 62, got $base\"))\n+end\n+\n+@noinline _invalid_digit(base, char) = throw(ArgumentError(\"invalid base $base digit $(repr(char))\"))\n+\n+function parse_char(::Type{T}, c::AbstractChar, base::Integer, throw::Bool) where T\n+    a::UInt8 = (base <= 36 ? 10 : 36)\n+    (2 <= base <= 62) || _invalid_base(base)\n+    base = base % UInt8\n+    cp = codepoint(c)\n+    cp = cp > 0x7a ? 0xff : cp % UInt8\n+    d = UInt8('0') \u2264 cp \u2264 UInt8('9') ? cp - UInt8('0') :\n+        UInt8('A') \u2264 cp \u2264 UInt8('Z') ? cp - UInt8('A') + UInt8(10) :\n+        UInt8('a') \u2264 cp \u2264 UInt8('z') ? cp - UInt8('a') + a :\n+        0xff\n+    d < base || (throw ? _invalid_digit(base, c) : return nothing)\n+    convert(T, d)::T\n+end\n+\n+function parse(::Type{T}, c::AbstractChar; base::Integer=10) where {T <: Integer}\n+    @inline parse_char(T, c, base, true)\n end\n \n+function tryparse(::Type{T}, c::AbstractChar; base::Integer=10) where {T <: Integer}\n+    @inline parse_char(T, c, base, false)\n+end\n+\n+# For consistency with parse(t, AbstractString), support a `base` argument only when T<:Integer\n+parse(::Type{T}, c::AbstractChar) where T = @inline parse_char(T, c, 10, true)\n+tryparse(::Type{T}, c::AbstractChar) where T = @inline parse_char(T, c, 10, false)\n+\n function parseint_iterate(s::AbstractString, startpos::Int, endpos::Int)\n     (0 < startpos <= endpos) || (return Char(0), 0, 0)\n     j = startpos\n@@ -116,8 +138,7 @@ function tryparse_internal(::Type{T}, s::AbstractString, startpos::Int, endpos::\n         return nothing\n     end\n     if !(2 <= base <= 62)\n-        raise && throw(ArgumentError(LazyString(\"invalid base: base must be 2 \u2264 base \u2264 62, got \", base)))\n-        return nothing\n+        raise ? _invalid_base(base) : return nothing\n     end\n     if i == 0\n         raise && throw(ArgumentError(\"premature end of integer: $(repr(SubString(s,startpos,endpos)))\"))\n@@ -236,7 +257,7 @@ end\n     if 2 <= base <= 62\n         return base\n     end\n-    throw(ArgumentError(\"invalid base: base must be 2 \u2264 base \u2264 62, got $base\"))\n+    _invalid_base(base)\n end\n \n \"\"\""
    },
    {
      "sha": "0bb549caf497347fbe22bbd5f2336075d9a1b1f0",
      "filename": "test/parse.jl",
      "status": "modified",
      "additions": 7,
      "deletions": 0,
      "changes": 7,
      "blob_url": "https://github.com/JuliaLang/julia/blob/b122d43d7f055a328c6d307e23f102f7c6c7c31b/test%2Fparse.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/b122d43d7f055a328c6d307e23f102f7c6c7c31b/test%2Fparse.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/test%2Fparse.jl?ref=b122d43d7f055a328c6d307e23f102f7c6c7c31b",
      "patch": "@@ -29,6 +29,13 @@\n     @test parse(Int, 'a', base=16) == 10\n     @test_throws ArgumentError parse(Int, 'a')\n     @test_throws ArgumentError parse(Int,typemax(Char))\n+\n+    @test tryparse(Int, '8') === 8\n+    @test tryparse(Int, 'a') === nothing\n+    @test tryparse(Int, 'a'; base=11) === 10\n+    @test tryparse(Int32, 'a'; base=11) === Int32(10)\n+    @test tryparse(UInt8, 'f'; base=16) === 0x0f\n+    @test tryparse(UInt8, 'f'; base=15) === nothing\n end\n \n # Issue 29451"
    }
  ]
}