{
  "url": "https://api.github.com/repos/JuliaLang/julia/issues/60593",
  "repository_url": "https://api.github.com/repos/JuliaLang/julia",
  "labels_url": "https://api.github.com/repos/JuliaLang/julia/issues/60593/labels{/name}",
  "comments_url": "https://api.github.com/repos/JuliaLang/julia/issues/60593/comments",
  "events_url": "https://api.github.com/repos/JuliaLang/julia/issues/60593/events",
  "html_url": "https://github.com/JuliaLang/julia/pull/60593",
  "id": 3790463024,
  "node_id": "PR_kwDOABkWpM67_yGX",
  "number": 60593,
  "title": "Markdown: better preserve newlines",
  "user": {
    "login": "fingolfin",
    "id": 241512,
    "node_id": "MDQ6VXNlcjI0MTUxMg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/241512?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fingolfin",
    "html_url": "https://github.com/fingolfin",
    "followers_url": "https://api.github.com/users/fingolfin/followers",
    "following_url": "https://api.github.com/users/fingolfin/following{/other_user}",
    "gists_url": "https://api.github.com/users/fingolfin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fingolfin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fingolfin/subscriptions",
    "organizations_url": "https://api.github.com/users/fingolfin/orgs",
    "repos_url": "https://api.github.com/users/fingolfin/repos",
    "events_url": "https://api.github.com/users/fingolfin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fingolfin/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2317339600,
      "node_id": "MDU6TGFiZWwyMzE3MzM5NjAw",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/markdown",
      "name": "markdown",
      "color": "D914CD",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 1,
  "created_at": "2026-01-07T21:47:52Z",
  "updated_at": "2026-01-08T10:53:51Z",
  "closed_at": "2026-01-08T10:53:49Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/JuliaLang/julia/pulls/60593",
    "html_url": "https://github.com/JuliaLang/julia/pull/60593",
    "diff_url": "https://github.com/JuliaLang/julia/pull/60593.diff",
    "patch_url": "https://github.com/JuliaLang/julia/pull/60593.patch",
    "merged_at": "2026-01-08T10:53:49Z"
  },
  "body": "This improves round-tripping of Markdown-to-Markdown. It also allows 20 additional CommonMark spec tests to pass.",
  "reactions": {
    "url": "https://api.github.com/repos/JuliaLang/julia/issues/60593/reactions",
    "total_count": 2,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 1,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/JuliaLang/julia/issues/60593/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "score": 1.0,
  "files": [
    {
      "sha": "bb85b4c023ee6aad8d9e397a3ce3bad0f7961d5f",
      "filename": "stdlib/Markdown/src/Common/block.jl",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/JuliaLang/julia/blob/a5ccfbb385dfaae5bc6ad822db4664754aa762f0/stdlib%2FMarkdown%2Fsrc%2FCommon%2Fblock.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/a5ccfbb385dfaae5bc6ad822db4664754aa762f0/stdlib%2FMarkdown%2Fsrc%2FCommon%2Fblock.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/stdlib%2FMarkdown%2Fsrc%2FCommon%2Fblock.jl?ref=a5ccfbb385dfaae5bc6ad822db4664754aa762f0",
      "patch": "@@ -24,7 +24,7 @@ function paragraph(stream::IO, md::MD)\n             elseif blankline(stream) || _parse(stream, md, breaking = true)\n                 break\n             else\n-                write(buffer, ' ')\n+                write(buffer, '\\n')\n             end\n         else\n             write(buffer, char)"
    },
    {
      "sha": "884d7b4edc457d7be44664ed5d3a803f3165a330",
      "filename": "stdlib/Markdown/src/Common/inline.jl",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/JuliaLang/julia/blob/a5ccfbb385dfaae5bc6ad822db4664754aa762f0/stdlib%2FMarkdown%2Fsrc%2FCommon%2Finline.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/a5ccfbb385dfaae5bc6ad822db4664754aa762f0/stdlib%2FMarkdown%2Fsrc%2FCommon%2Finline.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/stdlib%2FMarkdown%2Fsrc%2FCommon%2Finline.jl?ref=a5ccfbb385dfaae5bc6ad822db4664754aa762f0",
      "patch": "@@ -60,11 +60,13 @@ end\n function inline_code(stream::IO, md::MD)\n     withstream(stream) do\n         ticks = matchstart(stream, r\"^(`+)\").match\n-        result = readuntil(stream, ticks)\n+        result = readuntil(stream, ticks; newlines=true)\n         if result === nothing\n             nothing\n         else\n             result = strip(result)\n+            # in code spans, newlines are replaced by spaces\n+            result = replace(result, '\\n' => ' ')\n             # An odd number of backticks wrapping the text will produce a `Code` node, while\n             # an even number will result in a `LaTeX` node. This allows for arbitrary\n             # backtick combinations to be embedded inside the resulting node, i.e."
    },
    {
      "sha": "13010db39053fbcae97df4aa8e1b7a9d041b0e2a",
      "filename": "stdlib/Markdown/test/runtests.jl",
      "status": "modified",
      "additions": 18,
      "deletions": 8,
      "changes": 26,
      "blob_url": "https://github.com/JuliaLang/julia/blob/a5ccfbb385dfaae5bc6ad822db4664754aa762f0/stdlib%2FMarkdown%2Ftest%2Fruntests.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/a5ccfbb385dfaae5bc6ad822db4664754aa762f0/stdlib%2FMarkdown%2Ftest%2Fruntests.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/stdlib%2FMarkdown%2Ftest%2Fruntests.jl?ref=a5ccfbb385dfaae5bc6ad822db4664754aa762f0",
      "patch": "@@ -16,7 +16,7 @@ import Base: show\n     @test md\"foo ~bar~ baz\" == MD(Paragraph([\"foo \", Strikethrough(\"bar\"), \" baz\"]))\n     @test md\"foo ~~bar~~ baz\" == MD(Paragraph([\"foo \", Strikethrough(\"bar\"), \" baz\"]))\n     @test md\"\"\"foo\n-    bar\"\"\" == MD(Paragraph([\"foo bar\"]))\n+    bar\"\"\" == MD(Paragraph([\"foo\\nbar\"]))\n     @test md\"\"\"foo\\\n     bar\"\"\" == MD(Paragraph([\"foo\", LineBreak(), \"bar\"]))\n \n@@ -80,7 +80,7 @@ end\n @testset \"linefeeds\" begin\n     @test isempty(Markdown.parse(\"\\r\"))\n     @test Markdown.parse(\"hello\\r\") == MD(Paragraph([\"hello\"]))\n-    @test Markdown.parse(\"hello\\r*julia*\") == MD(Paragraph(Any[\"hello \", Italic(Any[\"julia\"])]))\n+    @test Markdown.parse(\"hello\\r*julia*\") == MD(Paragraph(Any[\"hello\\n\", Italic(Any[\"julia\"])]))\n end\n \n @testset \"footnotes\" begin\n@@ -376,7 +376,7 @@ end\n     @test md\"<mailto://a@example.com>\" |> html == \"\"\"<p><a href=\"mailto://a@example.com\">mailto://a@example.com</a></p>\\n\"\"\"\n     @test md\"<https://julialang.org/not a link>\" |> html == \"<p>&lt;https://julialang.org/not a link&gt;</p>\\n\"\n     @test md\"\"\"<https://julialang.org/nota\n-    link>\"\"\" |> html == \"<p>&lt;https://julialang.org/nota link&gt;</p>\\n\"\n+    link>\"\"\" |> html == \"<p>&lt;https://julialang.org/nota\\nlink&gt;</p>\\n\"\n     @test md\"\"\"Hello\n \n     ---\n@@ -399,7 +399,14 @@ end\n     h2\n     ---\n     not\n-    == =\"\"\" |> html == \"<h1>h1</h1>\\n<h2>h2</h2>\\n<p>not == =</p>\\n\"\n+    == =\"\"\" |> html ==\n+    \"\"\"\n+    <h1>h1</h1>\n+    <h2>h2</h2>\n+    <p>not\n+    == =</p>\n+    \"\"\"\n+\n end\n \n @testset \"the 'book' example input\" begin\n@@ -634,7 +641,7 @@ end\n     @test md\"\"\"\n     no|table\n     no error\n-    \"\"\" == MD([Paragraph(Any[\"no|table no error\"])])\n+    \"\"\" == MD([Paragraph(Any[\"no|table\\nno error\"])])\n \n     t = \"\"\"a   |   b\n     :-- | --:\n@@ -1069,7 +1076,8 @@ end\n     # Rendering tests.\n     expected =\n             \"\"\"\n-            1. A paragraph with two lines.\n+            1. A paragraph\n+               with two lines.\n \n                ```\n                indented code\n@@ -1099,7 +1107,8 @@ end\n     expected =\n             \"\"\"\n             <ol>\n-            <li><p>A paragraph with two lines.</p>\n+            <li><p>A paragraph\n+            with two lines.</p>\n             <pre><code>indented code\n             </code></pre>\n             <blockquote>\n@@ -1137,7 +1146,8 @@ end\n \n     expected =\n             \"\"\"\n-            1. A paragraph with two lines.\n+            1. A paragraph\n+               with two lines.\n \n                .. code-block:: julia\n "
    },
    {
      "sha": "2de798b7d8ea45e4c6b032b135b2f910d172b814",
      "filename": "stdlib/Markdown/test/test_spec.jl",
      "status": "modified",
      "additions": 20,
      "deletions": 20,
      "changes": 40,
      "blob_url": "https://github.com/JuliaLang/julia/blob/a5ccfbb385dfaae5bc6ad822db4664754aa762f0/stdlib%2FMarkdown%2Ftest%2Ftest_spec.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/a5ccfbb385dfaae5bc6ad822db4664754aa762f0/stdlib%2FMarkdown%2Ftest%2Ftest_spec.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/stdlib%2FMarkdown%2Ftest%2Ftest_spec.jl?ref=a5ccfbb385dfaae5bc6ad822db4664754aa762f0",
      "patch": "@@ -191,7 +191,7 @@ end\n     input = \"&nbsp &x; &#; &#x;\\n&#87654321;\\n&#abcdef0;\\n&ThisIsNotDefined; &hi?;\\n\"\n     expected = \"<p>&amp;nbsp &amp;x; &amp;#; &amp;#x;\\n&amp;#87654321;\\n&amp;#abcdef0;\\n&amp;ThisIsNotDefined; &amp;hi?;</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 29\n     input = \"&copy\\n\"\n@@ -579,7 +579,7 @@ end\n     input = \"Foo\\n= =\\n\\nFoo\\n--- -\\n\"\n     expected = \"<p>Foo\\n= =</p>\\n<p>Foo</p>\\n<hr />\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 89\n     input = \"Foo  \\n-----\\n\"\n@@ -675,13 +675,13 @@ end\n     input = \"Foo\\nbar\\n\\n---\\n\\nbaz\\n\"\n     expected = \"<p>Foo\\nbar</p>\\n<hr />\\n<p>baz</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 105\n     input = \"Foo\\nbar\\n* * *\\nbaz\\n\"\n     expected = \"<p>Foo\\nbar</p>\\n<hr />\\n<p>baz</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 106\n     input = \"Foo\\nbar\\n\\\\---\\nbaz\\n\"\n@@ -935,7 +935,7 @@ end\n     input = \"``` aa ```\\nfoo\\n\"\n     expected = \"<p><code>aa</code>\\nfoo</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 146\n     input = \"~~~ aa ``` ~~~\\nfoo\\n~~~\\n\"\n@@ -1357,7 +1357,7 @@ end\n     input = \"Foo\\n[bar]: /baz\\n\\n[bar]\\n\"\n     expected = \"<p>Foo\\n[bar]: /baz</p>\\n<p>[bar]</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 214\n     input = \"# [Foo]\\n[foo]: /url\\n> bar\\n\"\n@@ -1406,7 +1406,7 @@ end\n     input = \"aaa\\nbbb\\n\\nccc\\nddd\\n\"\n     expected = \"<p>aaa\\nbbb</p>\\n<p>ccc\\nddd</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 221\n     input = \"aaa\\n\\n\\nbbb\\n\"\n@@ -1430,7 +1430,7 @@ end\n     input = \"   aaa\\nbbb\\n\"\n     expected = \"<p>aaa\\nbbb</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 225\n     input = \"    aaa\\nbbb\\n\"\n@@ -1468,19 +1468,19 @@ end\n     input = \"> # Foo\\n> bar\\n> baz\\n\"\n     expected = \"<blockquote>\\n<h1>Foo</h1>\\n<p>bar\\nbaz</p>\\n</blockquote>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 229\n     input = \"># Foo\\n>bar\\n> baz\\n\"\n     expected = \"<blockquote>\\n<h1>Foo</h1>\\n<p>bar\\nbaz</p>\\n</blockquote>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 230\n     input = \"   > # Foo\\n   > bar\\n > baz\\n\"\n     expected = \"<blockquote>\\n<h1>Foo</h1>\\n<p>bar\\nbaz</p>\\n</blockquote>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 231\n     input = \"    > # Foo\\n    > bar\\n    > baz\\n\"\n@@ -1558,7 +1558,7 @@ end\n     input = \"> foo\\n> bar\\n\"\n     expected = \"<blockquote>\\n<p>foo\\nbar</p>\\n</blockquote>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 244\n     input = \"> foo\\n>\\n> bar\\n\"\n@@ -1625,7 +1625,7 @@ end\n     input = \"A paragraph\\nwith two lines.\\n\\n    indented code\\n\\n> A block quote.\\n\"\n     expected = \"<p>A paragraph\\nwith two lines.</p>\\n<pre><code>indented code\\n</code></pre>\\n<blockquote>\\n<p>A block quote.</p>\\n</blockquote>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 254\n     input = \"1.  A paragraph\\n    with two lines.\\n\\n        indented code\\n\\n    > A block quote.\\n\"\n@@ -2499,7 +2499,7 @@ end\n     input = \"**Gomphocarpus (*Gomphocarpus physocarpus*, syn.\\n*Asclepias physocarpa*)**\\n\"\n     expected = \"<p><strong>Gomphocarpus (<em>Gomphocarpus physocarpus</em>, syn.\\n<em>Asclepias physocarpa</em>)</strong></p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 395\n     input = \"**foo \\\"*bar*\\\" foo**\\n\"\n@@ -2565,7 +2565,7 @@ end\n     input = \"*foo\\nbar*\\n\"\n     expected = \"<p><em>foo\\nbar</em></p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 406\n     input = \"_foo __bar__ baz_\\n\"\n@@ -2673,7 +2673,7 @@ end\n     input = \"**foo\\nbar**\\n\"\n     expected = \"<p><strong>foo\\nbar</strong></p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 424\n     input = \"__foo _bar_ baz__\\n\"\n@@ -3082,7 +3082,7 @@ end\n     input = \"[link](foo\\nbar)\\n\"\n     expected = \"<p>[link](foo\\nbar)</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 491\n     input = \"[link](<foo\\nbar>)\\n\"\n@@ -3889,7 +3889,7 @@ end\n     input = \"< a><\\nfoo><bar/ >\\n<foo bar=baz\\nbim!bop />\\n\"\n     expected = \"<p>&lt; a&gt;&lt;\\nfoo&gt;&lt;bar/ &gt;\\n&lt;foo bar=baz\\nbim!bop /&gt;</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 622\n     input = \"<a href='bar'title=title>\\n\"\n@@ -4016,7 +4016,7 @@ end\n     input = \"`code\\\\\\nspan`\\n\"\n     expected = \"<p><code>code\\\\ span</code></p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 642\n     input = \"<a href=\\\"foo  \\nbar\\\">\\n\"\n@@ -4065,7 +4065,7 @@ end\n     input = \"foo\\nbaz\\n\"\n     expected = \"<p>foo\\nbaz</p>\\n\"\n     actual = Markdown.html(Markdown.parse(input))\n-    @test_broken expected == actual\n+    @test expected == actual\n \n     # Example 649\n     input = \"foo \\n baz\\n\""
    }
  ]
}