{
  "url": "https://api.github.com/repos/JuliaLang/julia/issues/60276",
  "repository_url": "https://api.github.com/repos/JuliaLang/julia",
  "labels_url": "https://api.github.com/repos/JuliaLang/julia/issues/60276/labels{/name}",
  "comments_url": "https://api.github.com/repos/JuliaLang/julia/issues/60276/comments",
  "events_url": "https://api.github.com/repos/JuliaLang/julia/issues/60276/events",
  "html_url": "https://github.com/JuliaLang/julia/pull/60276",
  "id": 3675834119,
  "node_id": "PR_kwDOABkWpM62FY4T",
  "number": 60276,
  "title": "Backports for 1.13.0-alpha2",
  "user": {
    "login": "KristofferC",
    "id": 1282691,
    "node_id": "MDQ6VXNlcjEyODI2OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1282691?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KristofferC",
    "html_url": "https://github.com/KristofferC",
    "followers_url": "https://api.github.com/users/KristofferC/followers",
    "following_url": "https://api.github.com/users/KristofferC/following{/other_user}",
    "gists_url": "https://api.github.com/users/KristofferC/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KristofferC/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KristofferC/subscriptions",
    "organizations_url": "https://api.github.com/users/KristofferC/orgs",
    "repos_url": "https://api.github.com/users/KristofferC/repos",
    "events_url": "https://api.github.com/users/KristofferC/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KristofferC/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 2,
  "created_at": "2025-11-28T20:12:34Z",
  "updated_at": "2025-11-30T08:28:31Z",
  "closed_at": "2025-11-30T08:28:30Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/JuliaLang/julia/pulls/60276",
    "html_url": "https://github.com/JuliaLang/julia/pull/60276",
    "diff_url": "https://github.com/JuliaLang/julia/pull/60276.diff",
    "patch_url": "https://github.com/JuliaLang/julia/pull/60276.patch",
    "merged_at": "2025-11-30T08:28:30Z"
  },
  "body": null,
  "reactions": {
    "url": "https://api.github.com/repos/JuliaLang/julia/issues/60276/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/JuliaLang/julia/issues/60276/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "score": 1.0,
  "files": [
    {
      "sha": "f658a48862d2cb88638041233ad5617f86338039",
      "filename": "Compiler/extras/CompilerDevTools/test/testpkg.jl",
      "status": "modified",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/Compiler%2Fextras%2FCompilerDevTools%2Ftest%2Ftestpkg.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/Compiler%2Fextras%2FCompilerDevTools%2Ftest%2Ftestpkg.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/Compiler%2Fextras%2FCompilerDevTools%2Ftest%2Ftestpkg.jl?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -1,6 +1,5 @@\n using Pkg\n \n Pkg.activate(dirname(@__DIR__)) do\n-  Pkg.instantiate()\n   include(\"runtests.jl\")\n end"
    },
    {
      "sha": "1a5f6860b185c676d936c339f3409124e2a927c4",
      "filename": "JuliaLowering/Manifest.toml",
      "status": "added",
      "additions": 16,
      "deletions": 0,
      "changes": 16,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/JuliaLowering%2FManifest.toml",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/JuliaLowering%2FManifest.toml",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/JuliaLowering%2FManifest.toml?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -0,0 +1,16 @@\n+# This file is machine-generated - editing it directly is not advised\n+\n+julia_version = \"1.14.0-DEV\"\n+manifest_format = \"2.1\"\n+project_hash = \"16f6f8d58c46fe20d68a941bfaddb4590471548a\"\n+\n+[[deps.JuliaLowering]]\n+deps = [\"JuliaSyntax\"]\n+path = \".\"\n+uuid = \"f3c80556-a63f-4383-b822-37d64f81a311\"\n+version = \"1.0.0-DEV\"\n+\n+[[deps.JuliaSyntax]]\n+path = \"../JuliaSyntax\"\n+uuid = \"70703baa-626e-46a2-a12c-08ffd08c73b4\"\n+version = \"2.0.0-DEV\""
    },
    {
      "sha": "7c44b68f574130dc4e9fbddd70bb0d9997acbad4",
      "filename": "base/loading.jl",
      "status": "modified",
      "additions": 3,
      "deletions": 0,
      "changes": 3,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/base%2Floading.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/base%2Floading.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/base%2Floading.jl?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -470,6 +470,8 @@ function locate_package_env(pkg::PkgId, stopenv::Union{String, Nothing}=nothing)\n             path = manifest_uuid_path(env, pkg)\n             # missing is used as a sentinel to stop looking further down in envs\n             if path === missing\n+                # Before stopping, try stdlib fallback\n+                is_stdlib(pkg) && @goto stdlib_fallback\n                 path = nothing\n                 @goto done\n             end\n@@ -481,6 +483,7 @@ function locate_package_env(pkg::PkgId, stopenv::Union{String, Nothing}=nothing)\n                 stopenv == env && break\n             end\n         end\n+        @label stdlib_fallback\n         # Allow loading of stdlibs if the name/uuid are given\n         # e.g. if they have been explicitly added to the project/manifest\n         mbypath = manifest_uuid_path(Sys.STDLIB, pkg)"
    },
    {
      "sha": "eae2fba8308d3ceba63110f8cfbb40428f0f8a9f",
      "filename": "contrib/generate_precompile.jl",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/contrib%2Fgenerate_precompile.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/contrib%2Fgenerate_precompile.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/contrib%2Fgenerate_precompile.jl?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -348,8 +348,8 @@ generate_precompile_statements() = try # Make sure `ansi_enablecursor` is printe\n             uuid = \"$pkguuid\"\n             \"\"\")\n         touch(joinpath(pkgpath, \"Manifest.toml\"))\n-        tmp_prec = tempname(prec_path)\n-        tmp_proc = tempname(prec_path)\n+        tmp_prec = tempname(prec_path; cleanup=false)\n+        tmp_proc = tempname(prec_path; cleanup=false)\n         s = \"\"\"\n             pushfirst!(DEPOT_PATH, $(repr(joinpath(prec_path,\"depot\"))));\n             Base.PRECOMPILE_TRACE_COMPILE[] = $(repr(tmp_prec));"
    },
    {
      "sha": "45f5692993470b1dabfeea1573caec5c56e924ce",
      "filename": "deps/checksums/Pkg-4f9884fdb867f2c928ba43dc41da5f150aaec4ab.tar.gz/md5",
      "status": "added",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/deps%2Fchecksums%2FPkg-4f9884fdb867f2c928ba43dc41da5f150aaec4ab.tar.gz%2Fmd5",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/deps%2Fchecksums%2FPkg-4f9884fdb867f2c928ba43dc41da5f150aaec4ab.tar.gz%2Fmd5",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/deps%2Fchecksums%2FPkg-4f9884fdb867f2c928ba43dc41da5f150aaec4ab.tar.gz%2Fmd5?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -0,0 +1 @@\n+cb635b45a66cab302b34bf56367e69d7"
    },
    {
      "sha": "c512a594e877d10e5c45a10748f8c4be31e53279",
      "filename": "deps/checksums/Pkg-4f9884fdb867f2c928ba43dc41da5f150aaec4ab.tar.gz/sha512",
      "status": "added",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/deps%2Fchecksums%2FPkg-4f9884fdb867f2c928ba43dc41da5f150aaec4ab.tar.gz%2Fsha512",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/deps%2Fchecksums%2FPkg-4f9884fdb867f2c928ba43dc41da5f150aaec4ab.tar.gz%2Fsha512",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/deps%2Fchecksums%2FPkg-4f9884fdb867f2c928ba43dc41da5f150aaec4ab.tar.gz%2Fsha512?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -0,0 +1 @@\n+40a0495141d6b220bbc6b4119369cdc86b22498ca6a9c83eba47aec397c4c92afa5776e9043b1545a3111ace0317ca0c2412d0ba51731a7505742f47545a5530"
    },
    {
      "sha": "51c075ed23ea113bbb921f4b2032d4c015f8981a",
      "filename": "deps/checksums/Pkg-d0be1daf22f15da346e83429b323a82554ef241c.tar.gz/md5",
      "status": "removed",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/JuliaLang/julia/blob/ef63ce3957e1b81a50ff49dc9259e88d9820912f/deps%2Fchecksums%2FPkg-d0be1daf22f15da346e83429b323a82554ef241c.tar.gz%2Fmd5",
      "raw_url": "https://github.com/JuliaLang/julia/raw/ef63ce3957e1b81a50ff49dc9259e88d9820912f/deps%2Fchecksums%2FPkg-d0be1daf22f15da346e83429b323a82554ef241c.tar.gz%2Fmd5",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/deps%2Fchecksums%2FPkg-d0be1daf22f15da346e83429b323a82554ef241c.tar.gz%2Fmd5?ref=ef63ce3957e1b81a50ff49dc9259e88d9820912f",
      "patch": "@@ -1 +0,0 @@\n-c98454356432e070a718a4b840f8619f"
    },
    {
      "sha": "302306e0f43ad6a3b072ee3e1521d9f5aae4fcc2",
      "filename": "deps/checksums/Pkg-d0be1daf22f15da346e83429b323a82554ef241c.tar.gz/sha512",
      "status": "removed",
      "additions": 0,
      "deletions": 1,
      "changes": 1,
      "blob_url": "https://github.com/JuliaLang/julia/blob/ef63ce3957e1b81a50ff49dc9259e88d9820912f/deps%2Fchecksums%2FPkg-d0be1daf22f15da346e83429b323a82554ef241c.tar.gz%2Fsha512",
      "raw_url": "https://github.com/JuliaLang/julia/raw/ef63ce3957e1b81a50ff49dc9259e88d9820912f/deps%2Fchecksums%2FPkg-d0be1daf22f15da346e83429b323a82554ef241c.tar.gz%2Fsha512",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/deps%2Fchecksums%2FPkg-d0be1daf22f15da346e83429b323a82554ef241c.tar.gz%2Fsha512?ref=ef63ce3957e1b81a50ff49dc9259e88d9820912f",
      "patch": "@@ -1 +0,0 @@\n-21fb5ed78bde81a7d2cf9bfe77a2bd52b5e792505cc2c55564366e5283af66f5cf60baf8b0cbb89b690bf424669c6b71220484eee4d65832d27ebe10a0334bb2"
    },
    {
      "sha": "c52fbb709b087453b17dc50269aa90a0ec8f48df",
      "filename": "deps/jlutilities/documenter/Manifest.toml",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/deps%2Fjlutilities%2Fdocumenter%2FManifest.toml",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/deps%2Fjlutilities%2Fdocumenter%2FManifest.toml",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/deps%2Fjlutilities%2Fdocumenter%2FManifest.toml?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -146,7 +146,7 @@ version = \"1.0.0\"\n [[deps.LibCURL_jll]]\n deps = [\"Artifacts\", \"CompilerSupportLibraries_jll\", \"LibSSH2_jll\", \"Libdl\", \"OpenSSL_jll\", \"Zlib_jll\", \"Zstd_jll\", \"nghttp2_jll\"]\n uuid = \"deac9b47-8bc7-5906-a0fe-35ac56dc84c0\"\n-version = \"8.16.0+0\"\n+version = \"8.17.0+0\"\n \n [[deps.LibGit2]]\n deps = [\"LibGit2_jll\", \"NetworkOptions\", \"Printf\", \"SHA\"]"
    },
    {
      "sha": "5b1d6d29db365435b929e8f2d7f06c0a20e45329",
      "filename": "deps/jlutilities/objectfile/Manifest.toml",
      "status": "added",
      "additions": 28,
      "deletions": 0,
      "changes": 28,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/deps%2Fjlutilities%2Fobjectfile%2FManifest.toml",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/deps%2Fjlutilities%2Fobjectfile%2FManifest.toml",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/deps%2Fjlutilities%2Fobjectfile%2FManifest.toml?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -0,0 +1,28 @@\n+# This file is machine-generated - editing it directly is not advised\n+\n+julia_version = \"1.14.0-DEV\"\n+manifest_format = \"2.1\"\n+project_hash = \"23b8253b8eadb7ba5d7489bb56f38819b7150654\"\n+\n+[[deps.ObjectFile]]\n+deps = [\"Reexport\", \"StructIO\"]\n+git-tree-sha1 = \"22faba70c22d2f03e60fbc61da99c4ebfc3eb9ba\"\n+registries = \"General\"\n+uuid = \"d8793406-e978-5875-9003-1fc021f44a92\"\n+version = \"0.5.0\"\n+\n+[[deps.Reexport]]\n+git-tree-sha1 = \"45e428421666073eab6f2da5c9d310d99bb12f9b\"\n+registries = \"General\"\n+uuid = \"189a3867-3050-52da-a836-e630ba90ab69\"\n+version = \"1.2.2\"\n+\n+[[deps.StructIO]]\n+git-tree-sha1 = \"c581be48ae1cbf83e899b14c07a807e1787512cc\"\n+registries = \"General\"\n+uuid = \"53d494c1-5632-5724-8f4c-31dff12d585f\"\n+version = \"0.3.1\"\n+\n+[registries.General]\n+url = \"https://github.com/JuliaRegistries/General.git\"\n+uuid = \"23338594-aafe-5451-b93e-139f81909106\""
    },
    {
      "sha": "acdde4be0965e06563a39180be81f0eba579b035",
      "filename": "deps/jlutilities/objectfile/Project.toml",
      "status": "added",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/deps%2Fjlutilities%2Fobjectfile%2FProject.toml",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/deps%2Fjlutilities%2Fobjectfile%2FProject.toml",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/deps%2Fjlutilities%2Fobjectfile%2FProject.toml?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -0,0 +1,2 @@\n+[deps]\n+ObjectFile = \"d8793406-e978-5875-9003-1fc021f44a92\""
    },
    {
      "sha": "ef9548c22a1edb458ec5574bdef23c7d744d9fba",
      "filename": "doc/make.jl",
      "status": "modified",
      "additions": 9,
      "deletions": 0,
      "changes": 9,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/doc%2Fmake.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/doc%2Fmake.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/doc%2Fmake.jl?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -228,6 +228,15 @@ BaseDocs = [\n \n StdlibDocs = [stdlib.targetfile for stdlib in STDLIB_DOCS]\n \n+# HACK: get nicer sorting here, even though we don't have the header\n+# of the .md files at hand.\n+sort!(StdlibDocs, by=function(x)\n+    x = replace(x, \"stdlib/\" => \"\")\n+    startswith(x, \"Libdl\") && return lowercase(\"Dynamic Linker\")\n+    startswith(x, \"Test\") && return lowercase(\"Unit Testing\")\n+    return lowercase(x)\n+end)\n+\n DevDocs = [\n     \"Documentation of Julia's Internals\" => [\n         \"devdocs/init.md\","
    },
    {
      "sha": "dea0c11dc1c8bb27dab277cbf4853b16b4b89864",
      "filename": "doc/src/index.md",
      "status": "modified",
      "additions": 8,
      "deletions": 46,
      "changes": 54,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/doc%2Fsrc%2Findex.md",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/doc%2Fsrc%2Findex.md",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/doc%2Fsrc%2Findex.md?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -32,18 +32,6 @@ Markdown.parse(\"\"\"\n \"\"\")\n ```\n \n-## [Important Links](@id man-important-links)\n-\n-Below is a non-exhaustive list of links that will be useful as you learn and use the Julia programming language.\n-\n-- [Julia Homepage](https://julialang.org)\n-- [Install Julia](https://julialang.org/install/)\n-- [Discussion forum](https://discourse.julialang.org)\n-- [Julia YouTube](https://www.youtube.com/user/JuliaLanguage)\n-- [Find Julia Packages](https://julialang.org/packages/)\n-- [Learning Resources](https://julialang.org/learning/)\n-- [Read and write blogs on Julia](https://forem.julialang.org)\n-\n ## [Introduction](@id man-introduction)\n \n Scientific computing has traditionally required the highest performance, yet domain experts have\n@@ -127,39 +115,13 @@ language. In addition to the above, some advantages of Julia over comparable sys\n   * Powerful shell-like capabilities for managing other processes\n   * Lisp-like macros and other metaprogramming facilities\n \n-## [Julia Standard Modules and the Standard Library](@id man-standard-modules-stdlib)\n-\n-The Julia runtime comes with [standard modules](@ref standard-modules),\n-which are essential namespaces that are usually loaded automatically.\n-\n-```@docs; canonical=false\n-Core\n-Base\n-```\n-\n-Julia's `Base` module contains various [useful submodules](@ref base-submodules).\n-\n-### [The Standard Library](@id man-stdlib)\n-\n-The Julia standard library contains additional, commonly used packages that are installed alongside the Julia runtime by default.\n-To use a standard library package, it is first necessary to load the package with a [`using`](@ref) or [`import`](@ref) statement.\n-Links to available standard library packages are provided below,\n-and may also be found in the website sidebar.\n-Their source code is available in the `Sys.STDLIB` directory of a Julia installation.\n-\n-```@eval\n-import Markdown\n-list = sort(filter(x -> match(r\"_jll$\", x) === nothing, readdir(Sys.STDLIB)))\n-Markdown.parse(join(\"- [`\" .* list .* \"`](stdlib/\" .* list .* \".html)\", \"\\n\"))\n-```\n+## [Important Links](@id man-important-links)\n \n-Julia also provides various standard, pre-built binary libraries\n-of established software that is written in other languages.\n-By convention, these packages have names that end with `_jll`.\n-The [`using`](@ref) statement can load symbol names from these binary libraries:\n+A non-exhaustive list of links that will be useful as you learn and use the Julia programming language:\n \n-```@eval\n-import Markdown\n-list = sort(filter(x -> match(r\"_jll$\", x) !== nothing, readdir(Sys.STDLIB)))\n-Markdown.parse(join(\"- [`\" .* list .* \"`](stdlib/\" .* list .* \".html)\", \"\\n\"))\n-```\n+- [Julia Homepage](https://julialang.org)\n+- [Install Julia](https://julialang.org/install/)\n+- [Discussion forum](https://discourse.julialang.org)\n+- [Julia YouTube](https://www.youtube.com/user/JuliaLanguage)\n+- [Find Julia Packages](https://julialang.org/packages/)\n+- [Learning Resources](https://julialang.org/learning/)"
    },
    {
      "sha": "5387ae1ed93ba696d15b47f7a37e1b8b12f0f5e4",
      "filename": "src/llvm-multiversioning.cpp",
      "status": "modified",
      "additions": 64,
      "deletions": 34,
      "changes": 98,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/src%2Fllvm-multiversioning.cpp",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/src%2Fllvm-multiversioning.cpp",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/src%2Fllvm-multiversioning.cpp?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -378,6 +378,8 @@ struct CloneCtx {\n     void clone_partial(Group &grp, Target &tgt);\n     uint32_t get_func_id(Function *F) const;\n     std::pair<uint32_t,GlobalVariable*> get_reloc_slot(Function *F) const;\n+\n+    Function *create_trampoline(Function *F, GlobalVariable *slot, bool autoinit=false);\n     void rewrite_alias(GlobalAlias *alias, Function* F);\n \n     MDNode *tbaa_const;\n@@ -493,6 +495,53 @@ void CloneCtx::prepare_vmap(ValueToValueMapTy &vmap)\n     }\n }\n \n+Function *CloneCtx::create_trampoline(Function *F, GlobalVariable *slot, bool autoinit)\n+{\n+    Function *trampoline =\n+        Function::Create(F->getFunctionType(), GlobalValue::ExternalLinkage, \"\", &M);\n+\n+    trampoline->copyAttributesFrom(F);\n+    trampoline->setVisibility(GlobalValue::HiddenVisibility);\n+    trampoline->setDSOLocal(true);\n+\n+    // drop multiversioning attributes\n+    trampoline->removeFnAttr(\"julia.mv.reloc\");\n+    trampoline->removeFnAttr(\"julia.mv.clones\");\n+\n+    auto BB = BasicBlock::Create(F->getContext(), \"top\", trampoline);\n+    IRBuilder<> irbuilder(BB);\n+\n+    if (autoinit) {\n+        irbuilder.CreateCall(F->getParent()->getOrInsertFunction(\n+            XSTR(jl_autoinit_and_adopt_thread),\n+            PointerType::get(F->getContext(), 0)\n+        ));\n+    }\n+\n+    auto ptr = irbuilder.CreateLoad(F->getType(), slot);\n+    ptr->setMetadata(llvm::LLVMContext::MD_tbaa, tbaa_const);\n+    ptr->setMetadata(llvm::LLVMContext::MD_invariant_load, MDNode::get(F->getContext(), None));\n+\n+    SmallVector<Value *, 0> Args;\n+    for (auto &arg : trampoline->args())\n+        Args.push_back(&arg);\n+    auto call = irbuilder.CreateCall(F->getFunctionType(), ptr, ArrayRef<Value *>(Args));\n+    if (F->isVarArg()) {\n+        assert(!TT.isARM() && !TT.isPPC() && \"musttail not supported on ARM/PPC!\");\n+        call->setTailCallKind(CallInst::TCK_MustTail);\n+    } else {\n+        call->setTailCallKind(CallInst::TCK_Tail);\n+\n+    }\n+\n+    if (F->getReturnType() == Type::getVoidTy(F->getContext()))\n+        irbuilder.CreateRetVoid();\n+    else\n+        irbuilder.CreateRet(call);\n+\n+    return trampoline;\n+}\n+\n void CloneCtx::prepare_slots()\n {\n     for (auto &F : orig_funcs) {\n@@ -507,7 +556,12 @@ void CloneCtx::prepare_slots()\n             else {\n                 auto id = get_func_id(F);\n                 const_relocs[id] = GV;\n-                GV->setInitializer(Constant::getNullValue(F->getType()));\n+\n+                // Initialize with a single-use trampoline that calls `jl_autoinit_and_adopt_thread`,\n+                // so that auto-initialization works with multi-versioned entrypoints.\n+                Function *trampoline = create_trampoline(F, GV, /* autoinit */ true);\n+                trampoline->setName(F->getName() + \".autoinit_trampoline\");\n+                GV->setInitializer(trampoline);\n             }\n         }\n     }\n@@ -665,45 +719,21 @@ void CloneCtx::rewrite_alias(GlobalAlias *alias, Function *F)\n {\n     assert(!is_vector(F->getFunctionType()));\n \n-    Function *trampoline =\n-        Function::Create(F->getFunctionType(), alias->getLinkage(), \"\", &M);\n-    trampoline->copyAttributesFrom(F);\n-    trampoline->takeName(alias);\n-    trampoline->setVisibility(alias->getVisibility());\n-    trampoline->setDSOLocal(alias->isDSOLocal());\n-    // drop multiversioning attributes, add alias attribute for testing purposes\n-    trampoline->removeFnAttr(\"julia.mv.reloc\");\n-    trampoline->removeFnAttr(\"julia.mv.clones\");\n-    trampoline->addFnAttr(\"julia.mv.alias\");\n-    trampoline->setDLLStorageClass(alias->getDLLStorageClass());\n-    alias->eraseFromParent();\n-\n     uint32_t id;\n     GlobalVariable *slot;\n     std::tie(id, slot) = get_reloc_slot(F);\n+    assert(slot);\n \n-    auto BB = BasicBlock::Create(F->getContext(), \"top\", trampoline);\n-    IRBuilder<> irbuilder(BB);\n+    Function *trampoline = create_trampoline(F, slot, /* autoinit */ false);\n+    trampoline->addFnAttr(\"julia.mv.alias\"); // add alias attribute for testing purposes\n \n-    auto ptr = irbuilder.CreateLoad(F->getType(), slot);\n-    ptr->setMetadata(llvm::LLVMContext::MD_tbaa, tbaa_const);\n-    ptr->setMetadata(llvm::LLVMContext::MD_invariant_load, MDNode::get(F->getContext(), None));\n-\n-    SmallVector<Value *, 0> Args;\n-    for (auto &arg : trampoline->args())\n-        Args.push_back(&arg);\n-    auto call = irbuilder.CreateCall(F->getFunctionType(), ptr, ArrayRef<Value *>(Args));\n-    if (F->isVarArg()) {\n-        assert(!TT.isARM() && !TT.isPPC() && \"musttail not supported on ARM/PPC!\");\n-        call->setTailCallKind(CallInst::TCK_MustTail);\n-    } else {\n-        call->setTailCallKind(CallInst::TCK_Tail);\n-    }\n+    trampoline->takeName(alias);\n+    trampoline->setLinkage(alias->getLinkage());\n+    trampoline->setVisibility(alias->getVisibility());\n+    trampoline->setDSOLocal(alias->isDSOLocal());\n+    trampoline->setDLLStorageClass(alias->getDLLStorageClass());\n \n-    if (F->getReturnType() == Type::getVoidTy(F->getContext()))\n-        irbuilder.CreateRetVoid();\n-    else\n-        irbuilder.CreateRet(call);\n+    alias->eraseFromParent();\n }\n \n void CloneCtx::fix_gv_uses()"
    },
    {
      "sha": "2970f3583bdf37dbb0aee865652944ac96b451c5",
      "filename": "stdlib/Pkg.version",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/stdlib%2FPkg.version",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/stdlib%2FPkg.version",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/stdlib%2FPkg.version?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -1,4 +1,4 @@\n PKG_BRANCH = release-1.13\n-PKG_SHA1 = d0be1daf22f15da346e83429b323a82554ef241c\n+PKG_SHA1 = 4f9884fdb867f2c928ba43dc41da5f150aaec4ab\n PKG_GIT_URL := https://github.com/JuliaLang/Pkg.jl.git\n PKG_TAR_URL = https://api.github.com/repos/JuliaLang/Pkg.jl/tarball/$1"
    },
    {
      "sha": "c4f5257a59988b9526de8cc6f67241f7c265d3b0",
      "filename": "test/llvmpasses/multiversioning-clone-only.ll",
      "status": "modified",
      "additions": 15,
      "deletions": 5,
      "changes": 20,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fllvmpasses%2Fmultiversioning-clone-only.ll",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fllvmpasses%2Fmultiversioning-clone-only.ll",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/test%2Fllvmpasses%2Fmultiversioning-clone-only.ll?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -7,7 +7,7 @@\n ; CHECK: @jl_fvar_idxs = hidden constant [1 x i32] zeroinitializer\n ; CHECK: @jl_gvar_idxs = hidden constant [0 x i32] zeroinitializer\n ; OPAQUE: @subtarget_cloned_gv = hidden global ptr null\n-; OPAQUE: @subtarget_cloned.reloc_slot = hidden global ptr null\n+; OPAQUE: @subtarget_cloned.reloc_slot = hidden global ptr @subtarget_cloned.autoinit_trampoline\n ; CHECK: @jl_fvar_count = hidden constant i64 1\n ; OPAQUE: @jl_fvar_ptrs = hidden global [1 x ptr] [ptr @subtarget_cloned]\n ; CHECK: @jl_clone_slots = hidden constant [5 x i32]\n@@ -57,7 +57,7 @@ define noundef i32 @subtarget_cloned(i32 noundef %0) #2 {\n ; COM: should fixup this callsite since 2 is cloned for a subtarget\n ; CHECK: define{{.*}}@call_subtarget_cloned({{.*}}#[[CALL_SUBTARGET_CLONED_DEFAULT_ATTRS:[0-9]+]]\n ; CHECK-NEXT: [[FUNC_PTR:%[0-9]+]] = load{{.*}}@subtarget_cloned.reloc_slot{{.*}}!tbaa ![[TBAA_CONST_METADATA:[0-9]+]], !invariant.load\n-; CHECK-NEXT: call{{.*}}[[FUNC_PTR]]\n+; CHECK-NEXT: call{{.*}}[[FUNC_PTR]]({{.*}})\n ; CHECK: ret i32\n define noundef i32 @call_subtarget_cloned(i32 noundef %0) #3 {\n     %2 = call noundef i32 @subtarget_cloned(i32 noundef %0)\n@@ -66,13 +66,23 @@ define noundef i32 @call_subtarget_cloned(i32 noundef %0) #3 {\n \n ; CHECK: define{{.*}}@call_subtarget_cloned_but_not_cloned({{.*}}#[[BORING_DEFAULT_ATTRS]]\n ; CHECK-NEXT: [[FUNC_PTR:%[0-9]+]] = load{{.*}}@subtarget_cloned.reloc_slot{{.*}}!tbaa ![[TBAA_CONST_METADATA]], !invariant.load\n-; CHECK-NEXT: call{{.*}}[[FUNC_PTR]]\n+; CHECK-NEXT: call{{.*}}[[FUNC_PTR]]({{.*}})\n ; CHECK: ret i32\n define noundef i32 @call_subtarget_cloned_but_not_cloned(i32 noundef %0) #0 {\n     %2 = call noundef i32 @subtarget_cloned(i32 noundef %0)\n     ret i32 %2\n }\n \n+; COM: check that the autoinit trampoline is generated correctly\n+; CHECK: define{{.*}}@subtarget_cloned.autoinit_trampoline({{.*}}\n+; CHECK-NEXT: top:\n+; CHECK-NEXT: call ptr @ijl_autoinit_and_adopt_thread()\n+; CHECK-NEXT: [[FUNC_PTR:%[0-9]+]] = load ptr, ptr @subtarget_cloned.reloc_slot{{.*}}!tbaa ![[TBAA_CONST_METADATA]], !invariant.load\n+; CHECK-NEXT: call{{.*}}[[FUNC_PTR]]({{.*}})\n+; CHECK: ret i32\n+\n+declare ptr @ijl_autoinit_and_adopt_thread()\n+\n ; CHECK: define{{.*}}@boring.1({{.*}}#[[BORING_CLONEALL_ATTRS:[0-9]+]]\n ; CHECK-NEXT: ret i32 %0\n \n@@ -106,10 +116,10 @@ define noundef i32 @call_subtarget_cloned_but_not_cloned(i32 noundef %0) #0 {\n ; CHECK-NOT: @subtarget_cloned_but_not_cloned.2\n \n ; COM: check for alias being rewritten to a function trampoline\n-; CHECK: define{{.*}}@subtarget_cloned_aliased{{.*}}#[[SUBTARGET_ALIASED_ATTRS:[0-9]+]]\n+; CHECK: define{{.*}}@subtarget_cloned_aliased{{[^.]*}}#[[SUBTARGET_ALIASED_ATTRS:[0-9]+]]\n ; CHECK-NOT: }\n ; CHECK: [[FUNC_PTR:%[0-9]+]] = load{{.*}}@subtarget_cloned.reloc_slot{{.*}}!tbaa ![[TBAA_CONST_METADATA]], !invariant.load\n-; CHECK-NEXT: call{{.*}}[[FUNC_PTR]]\n+; CHECK-NEXT: call{{.*}}[[FUNC_PTR]]({{.*}})\n ; CHECK: ret i32\n \n ; CHECK: attributes #[[BORING_DEFAULT_ATTRS]]"
    },
    {
      "sha": "e2918d0c20eec7f7ed4123d4e3b1520f5caa8690",
      "filename": "test/llvmpasses/multiversioning-x86.ll",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fllvmpasses%2Fmultiversioning-x86.ll",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fllvmpasses%2Fmultiversioning-x86.ll",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/test%2Fllvmpasses%2Fmultiversioning-x86.ll?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -11,7 +11,7 @@\n ; OPAQUE: @jl_gvar_ptrs = global [0 x ptr] zeroinitializer, align 8\n ; CHECK: @jl_fvar_idxs = hidden constant [5 x i32] [i32 0, i32 1, i32 2, i32 3, i32 4], align 8\n ; CHECK: @jl_gvar_idxs = hidden constant [0 x i32] zeroinitializer, align 8\n-; OPAQUE: @simd_test.reloc_slot = hidden global ptr null\n+; OPAQUE: @simd_test.reloc_slot = hidden global ptr @simd_test.autoinit_trampoline\n ; OPAQUE: @jl_fvar_ptrs = hidden global [5 x ptr] [ptr @boring, ptr @fastmath_test, ptr @loop_test, ptr @simd_test, ptr @simd_test_call]\n ; OPAQUE: @jl_clone_slots = hidden constant [3 x i32] [i32 1, i32 3, i32 trunc (i64 sub (i64 ptrtoint (ptr @simd_test.reloc_slot to i64), i64 ptrtoint (ptr @jl_clone_slots to i64)) to i32)]\n ; CHECK: @jl_clone_idxs = hidden constant [10 x i32] [i32 -2147483647, i32 3, i32 -2147483647, i32 3, i32 4, i32 1, i32 1, i32 2, i32 -2147483645, i32 4]"
    },
    {
      "sha": "4baf979cf128af4c3ea2f6a7776482dba0c60144",
      "filename": "test/loading.jl",
      "status": "modified",
      "additions": 20,
      "deletions": 1,
      "changes": 21,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Floading.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Floading.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/test%2Floading.jl?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -1533,12 +1533,31 @@ end\n end\n \n @testset \"Fallback for stdlib deps if manifest deps aren't found\" begin\n+    s = Sys.iswindows() ? ';' : ':'\n     mktempdir() do depot\n         # This manifest has a LibGit2 entry that is missing LibGit2_jll, which should be\n         # handled by falling back to the stdlib Project.toml for dependency truth.\n-        badmanifest_test_dir = joinpath(@__DIR__, \"project\", \"deps\", \"BadStdlibDeps.jl\")\n+        badmanifest_test_dir = joinpath(@__DIR__, \"project\", \"deps\", \"BadStdlibDeps\")\n         @test success(addenv(\n             `$(Base.julia_cmd()) --project=$badmanifest_test_dir --startup-file=no -e 'using LibGit2'`,\n+            \"JULIA_DEPOT_PATH\" => string(depot * Base.Filesystem.pathsep(), s),\n+        ))\n+    end\n+    mktempdir() do depot\n+        # This manifest has a LibGit2 entry that has a LibGit2_jll with a git-tree-hash1\n+        # which simulates an old manifest where LibGit2_jll was not a stdlib\n+        badmanifest_test_dir2 = joinpath(@__DIR__, \"project\", \"deps\", \"BadStdlibDeps2\")\n+        @test success(addenv(\n+            `$(Base.julia_cmd()) --project=$badmanifest_test_dir2 --startup-file=no -e 'using LibGit2'`,\n+            \"JULIA_DEPOT_PATH\" => string(depot * Base.Filesystem.pathsep(), s),\n+        ))\n+    end\n+    mktempdir() do depot\n+        # This manifest has a LibGit2 entry that has a LibGit2_jll with a git-tree-hash1\n+        # which simulates an old manifest where LibGit2_jll was not a stdlib\n+        badmanifest_test_dir2 = joinpath(@__DIR__, \"project\", \"deps\", \"BadStdlibDeps2\")\n+        @test success(addenv(\n+            `$(Base.julia_cmd()) --project=$badmanifest_test_dir2 --startup-file=no -e 'using LibGit2'`,\n             \"JULIA_DEPOT_PATH\" => depot * Base.Filesystem.pathsep(),\n         ))\n     end"
    },
    {
      "sha": "988efc8da56f3b388d1b08189b00f68ada995869",
      "filename": "test/project/deps/BadStdlibDeps2/Manifest.toml",
      "status": "added",
      "additions": 54,
      "deletions": 0,
      "changes": 54,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fproject%2Fdeps%2FBadStdlibDeps2%2FManifest.toml",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fproject%2Fdeps%2FBadStdlibDeps2%2FManifest.toml",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/test%2Fproject%2Fdeps%2FBadStdlibDeps2%2FManifest.toml?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -0,0 +1,54 @@\n+# This file is machine-generated - editing it directly is not advised\n+\n+julia_version = \"1.12.0-DEV\"\n+manifest_format = \"2.0\"\n+project_hash = \"dc9d33b0ee13d9466bdb75b8d375808a534a79ec\"\n+\n+[[deps.Artifacts]]\n+uuid = \"56f22d72-fd6d-98f1-02f0-08ddc0907c33\"\n+version = \"1.11.0\"\n+\n+[[deps.LibGit2]]\n+deps = [\"NetworkOptions\", \"Printf\", \"SHA\", \"LibGit2_jll\"]\n+uuid = \"76f85450-5226-5b5a-8eaa-529ad045b433\"\n+version = \"1.11.0\"\n+\n+# This is an stdlib but intentionally has a git-tree-sha1 because\n+# we are emulating that the manifest comes from a version where\n+# LibGit2_jll was not an stdlib\n+[[deps.LibGit2_jll]]\n+deps = [\"Artifacts\", \"LibSSH2_jll\", \"Libdl\", \"MbedTLS_jll\"]\n+git-tree-sha1 = \"1111111111111111111111111111111111111111\"\n+uuid = \"e37daf67-58a4-590a-8e99-b0245dd2ffc5\"\n+version = \"1.8.0+0\"\n+\n+[[deps.LibSSH2_jll]]\n+deps = [\"Artifacts\", \"Libdl\", \"MbedTLS_jll\"]\n+uuid = \"29816b5a-b9ab-546f-933c-edad1886dfa8\"\n+version = \"1.11.0+1\"\n+\n+[[deps.Libdl]]\n+uuid = \"8f399da3-3557-5675-b5ff-fb832c97cbdb\"\n+version = \"1.11.0\"\n+\n+[[deps.MbedTLS_jll]]\n+deps = [\"Artifacts\", \"Libdl\"]\n+uuid = \"c8ffd9c3-330d-5841-b78e-0817d7145fa1\"\n+version = \"2.28.6+1\"\n+\n+[[deps.NetworkOptions]]\n+uuid = \"ca575930-c2e3-43a9-ace4-1e988b2c1908\"\n+version = \"1.2.0\"\n+\n+[[deps.Printf]]\n+deps = [\"Unicode\"]\n+uuid = \"de0858da-6303-5e67-8744-51eddeeeb8d7\"\n+version = \"1.11.0\"\n+\n+[[deps.SHA]]\n+uuid = \"ea8e919c-243c-51af-8825-aaa63cd721ce\"\n+version = \"0.7.0\"\n+\n+[[deps.Unicode]]\n+uuid = \"4ec0a83e-493e-50e2-b9ac-8f72acf5a8f5\"\n+version = \"1.11.0\""
    },
    {
      "sha": "223889185ea15b2d6c39ada53a92ff849bb0f3a8",
      "filename": "test/project/deps/BadStdlibDeps2/Project.toml",
      "status": "added",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fproject%2Fdeps%2FBadStdlibDeps2%2FProject.toml",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fproject%2Fdeps%2FBadStdlibDeps2%2FProject.toml",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/test%2Fproject%2Fdeps%2FBadStdlibDeps2%2FProject.toml?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -0,0 +1,2 @@\n+[deps]\n+LibGit2 = \"76f85450-5226-5b5a-8eaa-529ad045b433\""
    },
    {
      "sha": "4c847884939ac7ab0aa302847641f2860c1dd1f2",
      "filename": "test/runtests.jl",
      "status": "modified",
      "additions": 1,
      "deletions": 0,
      "changes": 1,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fruntests.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fruntests.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/test%2Fruntests.jl?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -28,6 +28,7 @@ end\n \n const rmwait_timeout = running_under_rr() ? 300 : 30\n \n+ENV[\"JULIA_TEST_BUILDROOT\"] = buildroot\n if use_revise\n     # First put this at the top of the DEPOT PATH to install revise if necessary.\n     # Once it's loaded, we swizzle it to the end, to avoid confusing any tests."
    },
    {
      "sha": "f034c650c75a0e4ecef782a55b481eb83fa048d1",
      "filename": "test/stdlib_dependencies.jl",
      "status": "modified",
      "additions": 31,
      "deletions": 16,
      "changes": 47,
      "blob_url": "https://github.com/JuliaLang/julia/blob/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fstdlib_dependencies.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/af3e3bb21e4cae85fb4694451c725adf54748cc1/test%2Fstdlib_dependencies.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/test%2Fstdlib_dependencies.jl?ref=af3e3bb21e4cae85fb4694451c725adf54748cc1",
      "patch": "@@ -1,14 +1,37 @@\n # This file is a part of Julia. License is MIT: https://julialang.org/license\n \n using Libdl\n-using Pkg\n using Test\n-prev_env = Base.active_project()\n-Pkg.activate(temp=true)\n-Pkg.add(Pkg.PackageSpec(name=\"ObjectFile\", uuid=\"d8793406-e978-5875-9003-1fc021f44a92\", version=\"0.4\"))\n-using ObjectFile\n-try\n \n+# Load ObjectFile.jl from the vendored jlutilities depot\n+buildroot = get(ENV, \"JULIA_TEST_BUILDROOT\", joinpath(@__DIR__, \"..\"))\n+depspath = joinpath(buildroot, \"deps\", \"jlutilities\")\n+if ispath(depspath)\n+    depspath = realpath(depspath)\n+    # With a source-tree use the vendored depot\n+    pushfirst!(DEPOT_PATH, joinpath(depspath, \"depot\"))\n+    using Pkg\n+    old_active_project = Base.active_project()\n+    Base.redirect_stdout(devnull) do\n+        Base.redirect_stderr(devnull) do\n+            Pkg.activate(realpath(joinpath(@__DIR__, \"..\", \"deps\", \"jlutilities\", \"objectfile\")))\n+            Pkg.instantiate()\n+        end\n+    end\n+    using ObjectFile\n+    popfirst!(DEPOT_PATH)\n+    Base.set_active_project(old_active_project)\n+else\n+    # Without a source-tree - expect that the user has installed it for us - warn otherwise\n+    ObjectFile_pkgid = Base.PkgId(Base.UUID(\"d8793406-e978-5875-9003-1fc021f44a92\"), \"ObjectFile\")\n+    if Base.locate_package(ObjectFile_pkgid) !== nothing\n+        @eval using ObjectFile\n+    end\n+end\n+\n+if !@isdefined(ObjectFile)\n+    @warn(\"ObjectFile.jl not available; skipping stdlib JLL dependency tests\")\n+else\n     strip_soversion(lib::AbstractString) = Base.BinaryPlatforms.parse_dl_name_version(lib)[1]\n \n     function get_deps_objectfile_macos(lib_path::String)\n@@ -249,8 +272,8 @@ try\n \n                     # This is a manually-managed special case\n                     if stdlib_name == \"libblastrampoline_jll\" &&\n-                       prop_name == :libblastrampoline &&\n-                       extraneous_deps in ([\"libopenblas64_\"], [\"libopenblas\"])\n+                        prop_name == :libblastrampoline &&\n+                        extraneous_deps in ([\"libopenblas64_\"], [\"libopenblas\"])\n                         deps_mismatch = false\n                     end\n \n@@ -315,12 +338,4 @@ try\n             end\n         end\n     end\n-\n-finally\n-    if prev_env !== nothing\n-        Pkg.activate(prev_env)\n-    else\n-        # If no previous environment, activate the default one\n-        Pkg.activate()\n-    end\n end"
    }
  ]
}