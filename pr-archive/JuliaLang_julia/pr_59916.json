{
  "url": "https://api.github.com/repos/JuliaLang/julia/issues/59916",
  "repository_url": "https://api.github.com/repos/JuliaLang/julia",
  "labels_url": "https://api.github.com/repos/JuliaLang/julia/issues/59916/labels{/name}",
  "comments_url": "https://api.github.com/repos/JuliaLang/julia/issues/59916/comments",
  "events_url": "https://api.github.com/repos/JuliaLang/julia/issues/59916/events",
  "html_url": "https://github.com/JuliaLang/julia/pull/59916",
  "id": 3532696596,
  "node_id": "PR_kwDOABkWpM6upTWr",
  "number": 59916,
  "title": "Use jl_effective_threads for container-aware CPU detection",
  "user": {
    "login": "KristofferC",
    "id": 1282691,
    "node_id": "MDQ6VXNlcjEyODI2OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1282691?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KristofferC",
    "html_url": "https://github.com/KristofferC",
    "followers_url": "https://api.github.com/users/KristofferC/followers",
    "following_url": "https://api.github.com/users/KristofferC/following{/other_user}",
    "gists_url": "https://api.github.com/users/KristofferC/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KristofferC/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KristofferC/subscriptions",
    "organizations_url": "https://api.github.com/users/KristofferC/orgs",
    "repos_url": "https://api.github.com/users/KristofferC/repos",
    "events_url": "https://api.github.com/users/KristofferC/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KristofferC/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 184008807,
      "node_id": "MDU6TGFiZWwxODQwMDg4MDc=",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/multithreading",
      "name": "multithreading",
      "color": "fbca04",
      "default": false,
      "description": "Base.Threads and related functionality"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 1,
  "created_at": "2025-10-20T14:35:24Z",
  "updated_at": "2025-10-22T23:22:41Z",
  "closed_at": "2025-10-22T23:22:39Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/JuliaLang/julia/pulls/59916",
    "html_url": "https://github.com/JuliaLang/julia/pull/59916",
    "diff_url": "https://github.com/JuliaLang/julia/pull/59916.diff",
    "patch_url": "https://github.com/JuliaLang/julia/pull/59916.patch",
    "merged_at": "2025-10-22T23:22:39Z"
  },
  "body": "\ud83d\udc68 It seems to me we should use the effective thread number basically everywhere when defaulting to running some threaded workload. Running with the raw cpu threads will explode quickly when running in a constrained environment.\r\n\r\n-----\r\n\r\n\ud83e\udd16 \r\n\r\nJulia was not respecting container CPU limits (Docker --cpus, Kubernetes\r\nCPU limits, cgroups) in several places, leading to oversubscription when\r\ndetermining parallelism.\r\n\r\nChanges:\r\n- src/aotcompile.cpp:2013: Use jl_effective_threads() for LLVM compilation threads\r\n- src/threading.c:760: Use jl_effective_threads() for GC thread capping/warnings\r\n- src/threading.c:842: Use jl_effective_threads() for JULIA_EXCLUSIVE mode validation\r\n- base/sysinfo.jl: Add Sys.EFFECTIVE_CPU_THREADS constant for user access\r\n- test/runtests.jl:119: Use Sys.EFFECTIVE_CPU_THREADS for test worker processes\r\n- base/precompilation.jl:529: Use Sys.EFFECTIVE_CPU_THREADS for precompilation tasks\r\n- base/util.jl:697: Use Sys.EFFECTIVE_CPU_THREADS for Base.runtests() default\r\n\r\nThe existing jl_effective_threads() function returns min(jl_cpu_threads(),\r\nuv_available_parallelism()), where uv_available_parallelism() respects\r\ncgroup limits.\r\n\r\n--------\r\n",
  "reactions": {
    "url": "https://api.github.com/repos/JuliaLang/julia/issues/59916/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/JuliaLang/julia/issues/59916/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "score": 1.0
}