{
  "url": "https://api.github.com/repos/JuliaLang/julia/issues/59165",
  "repository_url": "https://api.github.com/repos/JuliaLang/julia",
  "labels_url": "https://api.github.com/repos/JuliaLang/julia/issues/59165/labels{/name}",
  "comments_url": "https://api.github.com/repos/JuliaLang/julia/issues/59165/comments",
  "events_url": "https://api.github.com/repos/JuliaLang/julia/issues/59165/events",
  "html_url": "https://github.com/JuliaLang/julia/pull/59165",
  "id": 3278854283,
  "node_id": "PR_kwDOABkWpM6hc-O_",
  "number": 59165,
  "title": "ccall: make distinction of pointer vs name a syntactic distinction",
  "user": {
    "login": "vtjnash",
    "id": 330950,
    "node_id": "MDQ6VXNlcjMzMDk1MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/330950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vtjnash",
    "html_url": "https://github.com/vtjnash",
    "followers_url": "https://api.github.com/users/vtjnash/followers",
    "following_url": "https://api.github.com/users/vtjnash/following{/other_user}",
    "gists_url": "https://api.github.com/users/vtjnash/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vtjnash/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vtjnash/subscriptions",
    "organizations_url": "https://api.github.com/users/vtjnash/orgs",
    "repos_url": "https://api.github.com/users/vtjnash/repos",
    "events_url": "https://api.github.com/users/vtjnash/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vtjnash/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1056009044,
      "node_id": "MDU6TGFiZWwxMDU2MDA5MDQ0",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/minor%20change",
      "name": "minor change",
      "color": "a05255",
      "default": false,
      "description": "Marginal behavior change acceptable for a minor release"
    },
    {
      "id": 2873907667,
      "node_id": "MDU6TGFiZWwyODczOTA3NjY3",
      "url": "https://api.github.com/repos/JuliaLang/julia/labels/ffi",
      "name": "ffi",
      "color": "75AF91",
      "default": false,
      "description": "foreign function interfaces, ccall, etc."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 35,
  "created_at": "2025-07-31T01:30:35Z",
  "updated_at": "2025-10-15T14:09:51Z",
  "closed_at": "2025-10-09T20:00:40Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/JuliaLang/julia/pulls/59165",
    "html_url": "https://github.com/JuliaLang/julia/pull/59165",
    "diff_url": "https://github.com/JuliaLang/julia/pull/59165.diff",
    "patch_url": "https://github.com/JuliaLang/julia/pull/59165.patch",
    "merged_at": "2025-10-09T20:00:40Z"
  },
  "body": "We have long expected users to be explicit about the library name for `ccall`, and the `@ccall` macro has even always enforced that. That means users should have already been using explicit syntax, even though it wasn't strictly enforced. And indeed, the other syntax forms weren't handled reliably anyways (since doing so would require linearizing IR if and only if the runtime values required it, which is not something that is computable, and thus was often done wrong). This now intends to align the runtime and compiler to expect only those syntax forms that we could reliably handle in the past without errors, and adds explicit errors for other cases, most of which we previously knew would be unreliable due to reliance upon inference in making particular decisions for the semantics. The `ccall` function is already very special since it is more like a actual macro (it does not exist as a binding or value), so we can make unusual syntax decisions like this, mirroring `@ccall` also.\r\n\r\nThis fixes #57931, mostly by restricting the set of things that are allowed to the set of things that have an obvious and pre-existing behavior to be guaranteed to do that behavior. The hope is to PkgEval this to check if any packages are doing something unusual and see if we even need to allow anything else.\r\n\r\nThis drops support for https://github.com/JuliaLang/julia/pull/37123, since we were going to use that for LazyLibraries, be we decided that approach was quite buggy and that PR would make static compilation quite impossible to support, so we instead actually implemented LazyLibraries with a different approach. It could be re-enabled, but we never had correct lowering or inference support for it, so it is presumably still unused.\r\n\r\nThe goal is to cause breakage only where the package authors really failed to express intent with syntax, and otherwise to explicitly maintain support by adding cases to normalize the given syntax into one of the supported cases. All existing functionality (and more) can be accessed by explicit management of a pointer or by a LazyLibrary-like type, so this shouldn't cause any reduction in possible functionality, just possibly altered syntax.\r\n\r\nIn followup work, we may want to apply some similar improvements to the cglobal semantics, though not nearly as urgent, since cglobal on a pointer is permitted as a complicated bitcast right now, which doesn't make sense and probably should be deprecated, so that there is no ambiguity with that function's meaning.\r\n\r\nMostly written by Claude",
  "reactions": {
    "url": "https://api.github.com/repos/JuliaLang/julia/issues/59165/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/JuliaLang/julia/issues/59165/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "score": 1.0
}