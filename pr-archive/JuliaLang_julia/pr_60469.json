{
  "url": "https://api.github.com/repos/JuliaLang/julia/issues/60469",
  "repository_url": "https://api.github.com/repos/JuliaLang/julia",
  "labels_url": "https://api.github.com/repos/JuliaLang/julia/issues/60469/labels{/name}",
  "comments_url": "https://api.github.com/repos/JuliaLang/julia/issues/60469/comments",
  "events_url": "https://api.github.com/repos/JuliaLang/julia/issues/60469/events",
  "html_url": "https://github.com/JuliaLang/julia/pull/60469",
  "id": 3759717704,
  "node_id": "PR_kwDOABkWpM66cu9w",
  "number": 60469,
  "title": "Backports more code quality PRs to v1.12",
  "user": {
    "login": "aviatesk",
    "id": 40514306,
    "node_id": "MDQ6VXNlcjQwNTE0MzA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/40514306?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aviatesk",
    "html_url": "https://github.com/aviatesk",
    "followers_url": "https://api.github.com/users/aviatesk/followers",
    "following_url": "https://api.github.com/users/aviatesk/following{/other_user}",
    "gists_url": "https://api.github.com/users/aviatesk/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aviatesk/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aviatesk/subscriptions",
    "organizations_url": "https://api.github.com/users/aviatesk/orgs",
    "repos_url": "https://api.github.com/users/aviatesk/repos",
    "events_url": "https://api.github.com/users/aviatesk/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aviatesk/received_events",
    "type": "User",
    "user_view_type": "public",
    "site_admin": false
  },
  "labels": [],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [],
  "milestone": null,
  "comments": 0,
  "created_at": "2025-12-24T09:03:17Z",
  "updated_at": "2025-12-27T15:28:07Z",
  "closed_at": "2025-12-27T15:28:05Z",
  "author_association": "MEMBER",
  "type": null,
  "active_lock_reason": null,
  "draft": false,
  "pull_request": {
    "url": "https://api.github.com/repos/JuliaLang/julia/pulls/60469",
    "html_url": "https://github.com/JuliaLang/julia/pull/60469",
    "diff_url": "https://github.com/JuliaLang/julia/pull/60469.diff",
    "patch_url": "https://github.com/JuliaLang/julia/pull/60469.patch",
    "merged_at": "2025-12-27T15:28:05Z"
  },
  "body": "- [x] #60461 \r\n- [x] #60465 \r\n- [x] #60466 \r\n",
  "reactions": {
    "url": "https://api.github.com/repos/JuliaLang/julia/issues/60469/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/JuliaLang/julia/issues/60469/timeline",
  "performed_via_github_app": null,
  "state_reason": null,
  "score": 1.0,
  "files": [
    {
      "sha": "9674bc170ad6e205ff9c8730de6a5babe631fbfe",
      "filename": "base/array.jl",
      "status": "modified",
      "additions": 7,
      "deletions": 7,
      "changes": 14,
      "blob_url": "https://github.com/JuliaLang/julia/blob/798e447360eefe0522fd7550e8722c64de707fc6/base%2Farray.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/798e447360eefe0522fd7550e8722c64de707fc6/base%2Farray.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/base%2Farray.jl?ref=798e447360eefe0522fd7550e8722c64de707fc6",
      "patch": "@@ -641,7 +641,7 @@ julia> collect(Float64, 1:2:5)\n collect(::Type{T}, itr) where {T} = _collect(T, itr, IteratorSize(itr))\n \n _collect(::Type{T}, itr, isz::Union{HasLength,HasShape}) where {T} =\n-    copyto!(_array_for(T, isz, _similar_shape(itr, isz)), itr)\n+    copyto!(_array_for_inner(T, isz, _similar_shape(itr, isz)), itr)\n function _collect(::Type{T}, itr, isz::SizeUnknown) where T\n     a = Vector{T}()\n     for x in itr\n@@ -665,12 +665,12 @@ _similar_for(c::AbstractArray, ::Type{T}, itr, ::HasShape, axs) where {T} =\n     similar(c, T, axs)\n \n # make a collection appropriate for collecting `itr::Generator`\n-_array_for(::Type{T}, ::SizeUnknown, ::Nothing) where {T} = Vector{T}(undef, 0)\n-_array_for(::Type{T}, ::HasLength, len::Integer) where {T} = Vector{T}(undef, Int(len))\n-_array_for(::Type{T}, ::HasShape{N}, axs) where {T,N} = similar(Array{T,N}, axs)\n+_array_for_inner(::Type{T}, ::SizeUnknown, ::Nothing) where {T} = Vector{T}(undef, 0)\n+_array_for_inner(::Type{T}, ::HasLength, len::Integer) where {T} = Vector{T}(undef, Int(len))\n+_array_for_inner(::Type{T}, ::HasShape{N}, axs) where {T,N} = similar(Array{T,N}, axs)\n \n # used by syntax lowering for simple typed comprehensions\n-_array_for(::Type{T}, itr, isz) where {T} = _array_for(T, isz, _similar_shape(itr, isz))\n+_array_for(::Type{T}, itr, isz) where {T} = _array_for_inner(T, isz, _similar_shape(itr, isz))\n \n \n \"\"\"\n@@ -789,10 +789,10 @@ function collect(itr::Generator)\n         shp = _similar_shape(itr, isz)\n         y = iterate(itr)\n         if y === nothing\n-            return _array_for(et, isz, shp)\n+            return _array_for_inner(et, isz, shp)\n         end\n         v1, st = y\n-        dest = _array_for(typeof(v1), isz, shp)\n+        dest = _array_for_inner(typeof(v1), isz, shp)\n         # The typeassert gives inference a helping hand on the element type and dimensionality\n         # (work-around for #28382)\n         et\u2032 = et <: Type ? Type : et"
    },
    {
      "sha": "7c2d8ebe86de8b19dded3a2061c87f99f0e01990",
      "filename": "base/file.jl",
      "status": "modified",
      "additions": 4,
      "deletions": 7,
      "changes": 11,
      "blob_url": "https://github.com/JuliaLang/julia/blob/798e447360eefe0522fd7550e8722c64de707fc6/base%2Ffile.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/798e447360eefe0522fd7550e8722c64de707fc6/base%2Ffile.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/base%2Ffile.jl?ref=798e447360eefe0522fd7550e8722c64de707fc6",
      "patch": "@@ -1267,22 +1267,19 @@ function rename(oldpath::AbstractString, newpath::AbstractString)\n end\n \n function sendfile(src::AbstractString, dst::AbstractString)\n-    src_open = false\n-    dst_open = false\n-    local src_file, dst_file\n+    src_file = nothing\n+    dst_file = nothing\n     try\n         src_file = open(src, JL_O_RDONLY)\n-        src_open = true\n         dst_file = open(dst, JL_O_CREAT | JL_O_TRUNC | JL_O_WRONLY, filemode(src_file))\n-        dst_open = true\n \n         bytes = filesize(stat(src_file))\n         sendfile(dst_file, src_file, Int64(0), Int(bytes))\n     finally\n-        if src_open && isopen(src_file)\n+        if src_file !== nothing && isopen(src_file)\n             close(src_file)\n         end\n-        if dst_open && isopen(dst_file)\n+        if dst_file !== nothing && isopen(dst_file)\n             close(dst_file)\n         end\n     end"
    },
    {
      "sha": "46208eeff419573abab7f75b4b8406de84e3a2f9",
      "filename": "base/toml_parser.jl",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/JuliaLang/julia/blob/798e447360eefe0522fd7550e8722c64de707fc6/base%2Ftoml_parser.jl",
      "raw_url": "https://github.com/JuliaLang/julia/raw/798e447360eefe0522fd7550e8722c64de707fc6/base%2Ftoml_parser.jl",
      "contents_url": "https://api.github.com/repos/JuliaLang/julia/contents/base%2Ftoml_parser.jl?ref=798e447360eefe0522fd7550e8722c64de707fc6",
      "patch": "@@ -716,8 +716,8 @@ function parse_array(l::Parser{Dates})::Err{Vector} where Dates\n         copyto_typed!(new, array)\n     elseif T === Union{}\n         new = Any[]\n-    elseif (T === TOMLDict) || (T == BigInt) || (T === UInt128) || (T === Int128) || (T <: Vector) ||\n-        (T === Dates.Date) || (T === Dates.Time) || (T === Dates.DateTime)\n+    elseif (T === TOMLDict) || (T === BigInt) || (T === UInt128) || (T === Int128) || (T <: Vector) ||\n+        (Dates !== nothing && ((T === Dates.Date) || (T === Dates.Time) || (T === Dates.DateTime)))\n         # do nothing, leave as Vector{Any}\n         new = array\n     else @assert false end"
    }
  ]
}