schema_version: "1.0"

pr:
  number: 59539
  title: "doc: HISTORY: single method for multiple functions"
  url: "https://github.com/JuliaLang/julia/pull/59539"
  diff_url: "https://github.com/JuliaLang/julia/pull/59539.diff"
  author: "nsajko"
  labels:
    - "docs"
  merged_at: "2025-10-22T21:30:19Z"
  merge_commit_sha: "31f43f65114c6aaf578043edec3038d446a37397"

scope:
  files_touched:
    - "HISTORY.md"
  components:
    - "Documentation"
  pipeline_stages: []

analysis:
  intent:
    summary: |
      This is a documentation-only PR that adds a changelog entry to HISTORY.md for Julia v1.12.
      The entry documents a new language feature implemented in PR #58131: the ability to define
      a single method that covers multiple functions using union types like Union{typeof(f), typeof(g)}.

      The actual implementation was done in PR #58131 which consolidated Julia's method table
      architecture from per-function MethodTables to a single global Core.GlobalMethods table.
      This PR merely documents that feature in the release notes.
    issue_links:
      - "https://github.com/JuliaLang/julia/issues/54620"
      - "https://github.com/JuliaLang/julia/pull/58131"

  direct_changes:
    - summary: "Added single changelog line to HISTORY.md under 'New language features' for v1.12"
      component: "Documentation"
      evidence:
        - source: "diff"
          path: "HISTORY.md"
          loc: "29-35"
          url: "https://github.com/JuliaLang/julia/blob/31f43f65114c6aaf578043edec3038d446a37397/HISTORY.md#L29-L35"
          diff_context: |
            @@ -29,6 +29,7 @@ New language features
             * `Threads.@spawn` now takes a `:samepool` argument to specify the same threadpool as the caller.
               `Threads.@spawn :samepool foo()` which is shorthand for `Threads.@spawn Threads.threadpool() foo()` ([#57109]).
             * The `@ccall` macro can now take a `gc_safe` argument, that if set to true allows the runtime to run garbage collection concurrently to the `ccall` ([#49933]).
            +* A single method covering multiple functions is now allowed in more cases. See issue #54620. ([#58131]).

             Language changes
             ----------------
          snippet: |
            * A single method covering multiple functions is now allowed in more cases. See issue #54620. ([#58131]).

  secondary_effects:
    - effect: "No secondary effects - documentation only"
      mechanism: |
        This PR only adds text to HISTORY.md. It does not modify any Julia source code,
        compiler internals, or runtime behavior. The documented feature was implemented
        in PR #58131, not in this PR.

        The feature being documented allows syntax like:
          (op::Union{typeof(+), typeof(*)})(a, b, c, xs...) = ...

        Previously, this would raise "ERROR: Method dispatch is unimplemented currently
        for this method signature" in certain cases. After PR #58131, this pattern works
        more broadly.

        Examples of this pattern already in Base (from bitarray.jl):
          map(::Union{typeof(~), typeof(!)}, A::BitArray) = bit_map!(~, similar(A), A)
          for (T, f) in ((:(Union{typeof(&), typeof(*), typeof(min)}), :(&)),
                         (:(Union{typeof(|), typeof(max)}),            :(|)),
                         (:(Union{typeof(xor), typeof(!=)}),           :xor), ...)
      downstream_surfaces:
        - "None - documentation change only"
      likelihood: "none"
      impact: "none"

  compatibility:
    internal_api: []
    behavioral:
      - change: "No behavioral changes"
        description: |
          This is purely a documentation PR. The actual feature was implemented in PR #58131.
          This PR only documents that feature in the Julia 1.12 release notes.
        impact: "none"

  performance:
    compile_time:
      - impact: "None"
        description: "Documentation change only - no code modified"
    runtime:
      - impact: "None"
        description: "Documentation change only - no code modified"

  risk:
    level: "low"
    rationale:
      - "Documentation-only change with zero code modifications"
      - "Adds a single line to HISTORY.md"
      - "No compiler or runtime components touched"
      - "Labeled 'docs' by maintainers"
      - "Cannot break any functionality"

  downstream_impact:
    packages: []
    surfaces: []
    notes: |
      This PR has ZERO impact on any downstream packages or compiler functionality.
      It is purely a changelog entry documenting a feature from PR #58131.

      The underlying feature (from PR #58131, NOT this PR) may be relevant to:
      - Packages that define methods with Union{typeof(f), typeof(g)} signatures
      - Meta-programming tools that generate such method definitions
      - Code that previously hit "Method dispatch is unimplemented" errors

      However, PR #59539 itself is just documentation.

  open_questions:
    - "The PR body states 'Needs manual backport to v1.12 NEWS' - was this completed? Check if NEWS.md on release-1.12 branch has this entry."

  recommendations:
    - "No action required for any downstream packages"
    - "For understanding the actual feature, refer to PR #58131 and issue #54620"
    - "The documented feature enables Union{typeof(f), typeof(g)} method dispatch"

classification:
  type: "documentation"
  compiler_relevant: false
  breaking_change: false
  requires_downstream_action: false

notes: |
  This PR is NOT a code change - it is purely documentation.

  Context about the documented feature (implemented in PR #58131):

  PROBLEM (issue #54620):
  Before PR #58131, Julia would raise an error when trying to define methods like:
    (f::Union{typeof(foo), typeof(bar)})(x) = something
  The error was: "Method dispatch is unimplemented currently for this method signature"

  SOLUTION (PR #58131):
  PR #58131 by vtjnash consolidated Julia's method table architecture:
  - Changed from per-function MethodTable instances to a single global Core.GlobalMethods
  - Enabled method dispatch on union types of function singletons
  - This allows defining one method that handles multiple function objects

  WHAT THIS PR DOES:
  PR #59539 simply adds a one-line changelog entry to HISTORY.md documenting this feature
  for the Julia v1.12 release notes.

  Files in PR #58131 that implemented the actual feature (for reference):
  - Compiler/src/Compiler.jl
  - Compiler/src/abstractinterpretation.jl
  - Compiler/src/stmtinfo.jl
  - Compiler/src/tfuncs.jl
  - Compiler/src/typeinfer.jl
  - Compiler/src/utilities.jl
  - base/Base_compiler.jl
  - base/reflection.jl
  - base/methodshow.jl
  - base/invalidation.jl
  - base/runtime_internals.jl
  - src/gf.c, src/method.c, src/module.c
  - src/julia.h, src/julia_internal.h

  Usage pattern enabled by PR #58131:

    # Instead of:
    for op in (+, -, *, /)
        @eval ($op)(a::MyType, b::MyType) = MyType($op(a.val, b.val))
    end

    # Can now write:
    (op::Union{typeof(+), typeof(-), typeof(*), typeof(/)})(a::MyType, b::MyType) =
        MyType(op(a.val, b.val))

  This is already used extensively in Base, e.g., in base/bitarray.jl:
    map(::Union{typeof(~), typeof(!)}, A::BitArray) = bit_map!(~, similar(A), A)

    for (T, f) in ((:(Union{typeof(&), typeof(*), typeof(min)}), :(&)),
                   (:(Union{typeof(|), typeof(max)}),            :(|)),
                   (:(Union{typeof(xor), typeof(!=)}),           :xor))
        @eval map(::$T, A::BitArray, B::BitArray) = bit_map!($f, similar(A), A, B)
    end

reviewer_verification:
  date: "2026-01-21"
  methodology: |
    Independent review conducted by examining:
    1. Cached PR JSON data at pr-archive/JuliaLang_julia/pr_59539.json
    2. Verified file count: exactly 1 file modified (HISTORY.md)
    3. Verified change stats: additions=1, deletions=0, changes=1
    4. Examined full patch context from PR JSON

  verified_claims:
    - claim: "Documentation-only change"
      verified: true
      evidence: "PR JSON shows files array contains only HISTORY.md with status 'modified'"

    - claim: "Single line addition"
      verified: true
      evidence: "PR JSON shows additions=1, deletions=0; patch shows single '+' line"

    - claim: "No compiler code touched"
      verified: true
      evidence: "files_touched array contains only 'HISTORY.md', no .jl or .c files"

    - claim: "Feature documented was implemented in PR #58131"
      verified: true
      evidence: "PR body explicitly references 'PR #58131' and issue '#54620'; changelog line includes ([#58131]) citation"

  additional_findings: |
    No additional code changes found. The analysis correctly identifies this as a
    pure documentation change with zero compiler impact.

    The PR was assigned to JeffBezanson and merged approximately 6 weeks after creation
    (created: 2025-09-12, merged: 2025-10-22).

  confidence: "high"
  reviewer_notes: |
    This is a textbook example of a documentation-only PR. The original analysis was
    thorough and accurate. The only enhancements made were:
    1. Added exact diff context from PR patch data
    2. Corrected line number reference from 188 to 29-35 (actual diff location)
    3. Consolidated open questions (removed redundant question)
    4. Added this verification section

    No additional secondary effects or downstream impacts to report - this PR
    cannot affect any compiler behavior since it modifies only HISTORY.md.
